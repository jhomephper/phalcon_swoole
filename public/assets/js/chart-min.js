/**
 * @fileOverview Chart \u6a21\u5757\u7684\u5165\u53e3
 * @ignore
 */define("bui/chart",["bui/common","bui/chart/chart","bui/chart/axis","bui/chart/series","bui/chart/plotrange","bui/chart/theme"],function(e){var t=e("bui/common"),n=t.namespace("Chart");return t.mix(n,{Chart:e("bui/chart/chart"),Axis:e("bui/chart/axis"),Series:e("bui/chart/series"),PlotRange:e("bui/chart/plotrange"),Theme:e("bui/chart/theme")}),n}),define("bui/chart/actived",function(e){var t=e("bui/common"),n=function(){};return n.ATTRS={actived:{value:!1}},t.augment(n,{isActived:function(){return this.get("actived")},setActived:function(){this.setActiveStatus(!0),this.set("actived",!0)},setActiveStatus:function(e){},clearActived:function(){this.setActiveStatus(!1),this.set("actived",!1),this.clearActivedItem&&this.clearActivedItem()}}),n}),define("bui/chart/activedgroup",function(e){var t=function(){};return t.ATTRS={},BUI.augment(t,{isItemActived:function(e){return e.isActived()},getActiveItems:function(){return this.get("children")},setItemActived:function(e,t){t?e.setActived():e.clearActived()},onActived:function(e){this.fireUpGroup("actived",e)},onUnActived:function(e){this.fireUpGroup("unactived",e)},setActivedItem:function(e){var t=this;t.clearActivedItem(),e&&!t.isItemActived(e)&&(t.setItemActived(e,!0),t.onActived())},getActived:function(){var e=this,t=e.getActiveItems(),n=null;return BUI.each(t,function(t){if(e.isItemActived(t))return n=t,!1}),n},clearActivedItem:function(e){var t=this;e=e||t.getActived(),e&&(t.setItemActived(e,!1),t.onUnActived(e))}}),t}),define("bui/chart/showlabels",["bui/chart/labels"],function(e){var t=e("bui/common"),n=e("bui/chart/labels"),r=function(){};return r.ATTRS={labels:{}},t.augment(r,{renderLabels:function(){var e=this,t=e.get("labels"),r;if(!t)return;t.items||(t.items=[]),r=e.addGroup(n,t),e.set("labelsGroup",r)},resetLabels:function(e){var n=this,r=n.get("labels");if(!r)return;var i=n.get("labelsGroup"),s=i.get("children"),o=s.length;e=e||r.items,t.each(e,function(e,t){if(t<o){var r=s[t];i.changeLabel(r,e)}else n.addLabel(e.text,e)});for(var u=o-1;u>=e.length;u--)s[u].remove()},addLabel:function(e,t){var n=this,r=n.get("labelsGroup"),i={},s;return r&&(i.text=e,i.x=t.x,i.y=t.y,i.point=t,s=r.addLabel(i)),s},removeLabels:function(){var e=this,t=e.get("labelsGroup");t&&t.remove()}}),r}),define("bui/chart/labels",["bui/common","bui/chart/plotitem","bui/graphic"],function(e){var t=e("bui/common"),n=e("bui/chart/plotitem"),r=e("bui/graphic").Util,i="x-chart-labels",s=function(e){s.superclass.constructor.call(this,e)};return s.ATTRS={elCls:{value:i},zIndex:{value:6},items:{},label:{},renderer:{},animate:{value:!0},duration:{value:400}},t.extend(s,n),t.augment(s,{renderUI:function(){var e=this;s.superclass.renderUI.call(e),e._drawLabels()},addLabel:function(e){var t=this,n=t.get("items"),r=n.length;return n.push(e),t._addLabel(e,r)},_drawLabels:function(){var e=this,n=e.get("items"),r;t.each(n,function(t,n){e._addLabel(t,n)})},_addLabel:function(e,t){var n=this,r=n._getLabelCfg(e,t);return n._createText(r)},_getLabelCfg:function(e,n){var r=this,i=r.get("label"),s=r.get("renderer");if(!t.isObject(e)){var o=e;e={},e.text=o}return s&&(e.text=s(e.text,e,n)),e.text==null&&(e.text=""),e.text=e.text.toString(),e.x=(e.x||0)+(i.x||0),e.y=(e.y||0)+(i.y||0),cfg=t.merge(i,e),cfg},changeLabel:function(e,n){var i=this,s=t.Array.indexOf(e,i.get("children")),o=i._getLabelCfg(n,s);if(e){e.attr("text",o.text);if(e.attr("x")!=o.x||e.attr("y")!=o.y)r.svg&&i.get("animate")&&!o.rotate?(o.rotate&&e.attr("transform",""),e.animate({x:o.x,y:o.y},i.get("duration"))):(e.attr(o),o.rotate&&e.attr("transform",t.substitute("r{rotate} {x} {y}",o)))}},_createText:function(e){return this.addShape("label",e)}}),s}),define("bui/chart/legend",["bui/common","bui/chart/plotitem","bui/chart/legenditem"],function(e){function o(e,t){return e>t?t:e}function u(e,t){return e>t?e:t}var t=e("bui/common"),n=e("bui/chart/plotitem"),r=e("bui/chart/legenditem"),i=15,s=5,a=function(e){a.superclass.constructor.call(this,e)};return a.ATTRS={zIndex:{value:8},elCls:{value:"x-chart-legend"},items:{},layout:{value:"horizontal"},dx:{value:0},dy:{value:0},align:{value:"bottom"},back:{value:{stroke:"#909090",fill:"#fff"}}},t.extend(a,n),t.augment(a,{renderUI:function(){var e=this;a.superclass.renderUI.call(e),e._renderItems(),e._renderBorder()},bindUI:function(){a.superclass.bindUI.call(e);var e=this;e.on("mousemove",function(e){e.stopPropagation()})},_renderItems:function(){var e=this,n=e.get("items"),r=e.addGroup();e.set("itemsGroup",r),t.each(n,function(t,n){e._addItem(t,n)})},addItem:function(e){var t=this,n=t.get("items");t._addItem(e,n.length),t.resetBorder(),t.resetPosition()},_addItem:function(e,n){var i=this,s=i.get("itemsGroup"),o=i._getNextX(),u=i._getNextY(),a=t.mix({x:o,y:u},e);a.legend=i,s.addGroup(r,a)},_renderBorder:function(){var e=this,n=e.get("back"),r,i,s,o;n&&(r=e._getTotalWidth(),i=e._getTotalHeight(),s=t.mix({r:5,width:r,height:i},n),o=e.addShape("rect",s),o.toBack(),e.set("borderShape",o))},resetBorder:function(){var e=this,t=e.get("borderShape");t&&t.attr({width:e._getTotalWidth(),height:e._getTotalHeight()})},resetPosition:function(){var e=this,t=e.get("align"),n=e.get("plotRange"),r=n.tl,i=n.br,s=e.get("dx"),o=e.get("dy"),u=e._getTotalWidth(),a,f;switch(t){case"top":a=r.x,f=r.y;break;case"left":a=r.x-u,f=(r.y+i.y)/2;break;case"right":a=i.x,f=(r.y+i.y)/2;break;case"bottom":a=(r.x+i.x)/2-u/2,f=i.y;default:}e.move(a+s,f+o)},_getCount:function(){return this.get("itemsGroup").get("children").length},_getNextX:function(){var e=this,n=e.get("layout"),r=s;if(n=="horizontal"){var i=e.get("itemsGroup").get("children");t.each(i,function(e){e.isGroup&&(r+=e.getWidth()+s)})}return r},_getNextY:function(){var e=this,t=e.get("layout");return t=="horizontal"?s:i*e._getCount()+s},_getTotalWidth:function(){var e=this;if(e.get("layout")=="horizontal")return this._getNextX();var n=e.get("itemsGroup").get("children"),r=s;return t.each(n,function(e){var t=e.getWidth();e.isGroup&&t>r&&(r=t)}),r+s*2},_getTotalHeight:function(){var e=this,t=e._getNextY();return e.get("layout")=="horizontal"?i+s*2:t+s}}),a}),define("bui/chart/legenditem",["bui/common","bui/chart/plotitem"],function(e){var t=e("bui/common"),n=e("bui/chart/plotitem"),r=20,i=function(e){i.superclass.constructor.call(this,e)};return i.ATTRS={elCls:{value:"x-chart-legend-item"},label:{},legend:{},series:{},x:{},y:{},hideColor:{value:"#CCC"}},t.extend(i,n),t.augment(i,{renderUI:function(){var e=this;i.superclass.renderUI.call(e),e._createShape(),e._createMarker(),e._createLabel()},bindUI:function(){var e=this;i.superclass.bindUI.call(e),e.bindMouseEvent(),e.bindClick()},bindMouseEvent:function(){var e=this,t=e.get("series");e.on("mouseover",function(e){t.setActived&&t.setActived()}).on("mouseout",function(e){t.clearActived&&t.clearActived()})},bindClick:function(){var e=this,t=e.get("series");e.on("click",function(){var n=t.get("visible");if(n){var r=t.get("parent"),i=r.getVisibleSeries().length;if(i==1)return}e._setVisible(!n)})},_setVisible:function(e){var t=this,n=t.get("series"),r=t.get("shape"),i=t.get("marker"),s=e?n.get("color"):t.get("hideColor");e?n.get("parent").showSeries(n):n.get("parent").hideSeries(n),r&&r.attr({stroke:s,fill:s}),i&&i.attr({stroke:s,fill:s})},_getBySeries:function(e){var t=this,n=t.get("series");return n.get(e)},getWidth:function(){var e=this,t=e.get("label");return t.getBBox().width+r},_createLabel:function(){var e=this,t=e._getBySeries("name"),n=e.addShape("label",{x:r,"text-anchor":"start",y:7,cursor:"pointer",text:t});e.set("label",n)},_createShape:function(){var e=this,t=e._getBySeries("type"),n=e._getBySeries("color"),r;switch(t){case"line":r=e.addShape("line",{x1:3,y1:7,x2:17,y2:7,stroke:n,"stroke-width":2});break;case"scatter":r=null;break;case"bubble":r=e.addShape("circle",{cx:10,cy:7,r:5,fill:n,stroke:n,"fill-opacity":.5});break;default:r=e.addShape("rect",{x:2,y:2,width:15,height:10,fill:n,stroke:n})}r&&r.attr("cursor","pointer"),e.set("shape",r)},_createMarker:function(){var e=this,n=e._getBySeries("markers"),r;n&&(r=t.mix({},n.marker),r.radius=3,r.x=10,r.y=7,r=e.addShape("marker",r)),e.set("marker",r)}}),i}),define("bui/chart/markers",["bui/chart/plotitem","bui/graphic","bui/chart/activedgroup"],function(e){var t=e("bui/common"),n=e("bui/graphic").Util,r=e("bui/chart/activedgroup"),i=e("bui/chart/plotitem"),s=function(e){s.superclass.constructor.call(this,e)};return t.extend(s,i),t.mixin(s,[r]),s.ATTRS={elCls:{value:"x-chart-markers"},zIndex:{value:6},marker:{},actived:{},single:{value:!1},xCache:{value:[],shared:!1}},t.augment(s,{renderUI:function(){var e=this;s.superclass.renderUI.call(e),e._drawMarkers()},isItemActived:function(e){return e.get("actived")},setItemActived:function(e,t){var n=this,r=n.get("marker"),i=n.get("actived"),s=n.get("single");t?(e.attr(i),e.set("actived",!0),s&&!e.get("visible")&&e.show()):(e.attr(r),e.set("actived",!1),s&&e.hide())},change:function(e){var r=this,i=r.get("children"),s=[];r.set("items",e),t.each(e,function(e,t){var o=i[t];o?(n.svg?o.animate({x:e.x,y:e.y},400):o.attr(e),s.push(e.x)):r._addMarker(e)});var o=r.getCount();for(var u=o-1;u>e.length-1;u--)r.getChildAt(u).remove();r.set("xCache",s)},_drawMarkers:function(){var e=this,n=e.get("single"),r=e.get("items");n&&(r=[{x:0,y:0,visible:!1}]),t.each(r,function(t){e._addMarker(t)})},addMarker:function(e){return this._addMarker(e)},_addMarker:function(e){var n=this,r=n.get("xCache"),i=n.get("marker"),s=t.merge(i,e);return r.push(parseInt(e.x)),n.addShape("marker",s)},getSnapMarker:function(e,r){var i=this,s=i.get("xCache"),o=i.get("single"),u;if(o)return i.getChildAt(0);if(t.isObject(e)){var a=i.get("children");t.each(a,function(t){if(t.attr("x")==e.x&&t.attr("y")==e.y)return u=t,!1})}else{var f=n.snapTo(s,e,r),l=t.Array.indexOf(f,s);u=i.getChildAt(l)}return u}}),s}),define("bui/chart/plotback",["bui/common","bui/chart/plotitem"],function(e){var t=e("bui/common"),n=e("bui/chart/plotitem"),r=e("bui/chart/plotrange"),i=function(e){i.superclass.constructor.call(this,e)};return i.ATTRS={elCls:{value:"x-chart-back"},zIndex:{value:0},margin:{value:20},plotRange:{},background:{},border:{}},t.extend(i,n),t.augment(i,{beforeRenderUI:function(){i.superclass.beforeRenderUI.call(this),this._calculateRange()},renderUI:function(){i.superclass.renderUI.call(this),this._renderBorder(),this._renderBackground()},_renderBorder:function(){var e=this,n=e.get("border"),r=e.get("canvas"),i;n&&(i=t.mix({width:r.get("width"),height:r.get("height")},n),this.addShape("rect",i))},_renderBackground:function(){var e=this,n=e.get("background"),r=e.get("plotRange"),i,s,o,u;n&&(i=r.getWidth(),s=r.getHeight(),o=r.tl,u={x:o.x,y:o.y,width:i,height:s},n.image?(u.src=n.image,e.addShape("image",u)):(t.mix(u,n),e.addShape("rect",u)))},_calculateRange:function(){var e=this,n=e.get("margin"),i=e.get("canvas"),s=i.get("width"),o=i.get("height"),u,a=0,f=0,l=0,c=0,h,p;t.isNumber(n)&&(a=f=l=c=n),t.isArray(n)&&(a=n[0],l=n[1]!=null?n[1]:n[0],c=n[2]!=null?n[2]:n[0],f=n[3]!=null?n[3]:l),h=i.getRelativePoint(f,o-c),p=i.getRelativePoint(s-l,a),u=new r(h,p),e.set("plotRange",u)}}),i}),define("bui/chart/plotitem",["bui/common","bui/graphic"],function(e){function r(e){if(e._attrs||e==n.Group)return;var i=e.superclass.constructor;i&&!i._attrs&&r(i),e._attrs={},t.mixAttrs(e._attrs,i._attrs),t.mixAttrs(e._attrs,e.ATTRS)}function i(e){r(this.constructor),i.superclass.constructor.call(this,e)}var t=e("bui/common"),n=e("bui/graphic");return i.ATTRS={itemName:{value:"item"},groupName:{value:""}},t.extend(i,n.Group),t.augment(i,{getDefaultCfg:function(){var e=this,n=e.constructor,r=n._attrs,i={};for(var s in r)if(r.hasOwnProperty(s)){var o=r[s],u=o.value;u!=null&&(o.shared===!1?(t.isObject(u)&&(i[s]={}),t.isArray(u)&&(i[s]=[]),t.mixAttr(i[s],u)):i[s]=u)}return i},fireUp:function(e,t){var n=this,r=n.get("canvas"),i=r.chart;i&&(t.target=t.target||i,i.fire(e,t))},fireUpGroup:function(e,t,n){var r=this,i=r.get("itemName"),s=r.get("groupName");n=n||{},n[i]=t,s&&(n[s]=r.get("parent")),r.fireUp(i.toLowerCase()+e,n)}}),i}),define("bui/chart/plotrange",function(e){function t(e,t){return e>t?t:e}function n(e,t){return e>t?e:t}function r(e,t){this.start=e,this.end=t,this.init()}return BUI.augment(r,{init:function(){var e=this;start=e.start,end=e.end;var r=e.tl={};r.x=t(start.x,end.x),r.y=t(start.y,end.y);var i=e.tr={};i.x=n(start.x,end.x),i.y=t(start.y,end.y);var s=e.bl={};s.x=t(start.x,end.x),s.y=n(start.y,end.y);var o=e.br={};o.x=n(start.x,end.x),o.y=n(start.y,end.y);var u=e.cc={};u.x=(o.x-r.x)/2+r.x,u.y=(o.y-r.y)/2+r.y},isInRange:function(e,t){BUI.isObject(e)&&(t=e.y,e=e.x);var n=this,r=n.tl,i=n.br;return e>=r.x&&e<=i.x&&t>=r.y&&t<=i.y},isInVertical:function(e){BUI.isObject(e)&&(e=e.y);var t=this,n=t.tl,r=t.br;return e>=n.y&&e<=r.y},isInHorizontal:function(e){BUI.isObject(e)&&(e=e.x);var t=this,n=t.tl,r=t.br;return e>=n.x&&e<=r.x},getWidth:function(){var e=this.tl,t=this.br;return t.x-e.x},getHeight:function(){var e=this.tl,t=this.br;return t.y-e.y}}),r}),define("bui/chart/theme",function(e){var t=e("bui/common"),n=function(e,t){return n.initTheme(e,t),e};n.initTheme=function(e,n){t.mix(!0,e,n)};var r={duration:1e3,line:{"stroke-width":2,"stroke-linejoin":"round","stroke-linecap":"round"},lineActived:{"stroke-width":3},markers:{marker:{radius:3},actived:{radius:6,stroke:"#fff"}},animate:!0};return n.Base=n({colors:["#5e90c9","#1c2d3f","#a9d052","#a12d2d","#43bbb4","#5a2a94","#fabe3c","#2279dc","#e360e5","#48000c"],symbols:["circle","diamond","square","triangle","triangle-down"],plotCfg:{margin:[50,50,100]},title:{"font-size":"16px","font-family":"SimSun,Georgia, Times, serif",fill:"#274b6d"},subTitle:{"font-size":14,"font-family":"tahoma,arial,SimSun,Georgia, Times, serif",fill:"#4d759e"},xAxis:{labels:{label:{y:12}}},yAxis:{line:null,tickLine:null,grid:{line:{stroke:"#c0c0c0"}},title:{text:"",rotate:-90,x:-30},position:"left",labels:{label:{x:-12}}},legend:{dy:30},seriesOptions:{lineCfg:r,areaCfg:r,bubbleCfg:{circle:{"stroke-width":1,"fill-opacity":.5},activeCircle:{"stroke-width":2}},pieCfg:{colors:["#5e90c9","#1c2d3f","#a9d052","#a12d2d","#43bbb4","#5a2a94","#fabe3c","#2279dc","#e360e5","#48000c"],item:{stroke:"#fff"},labels:{distance:30,label:{}}}},tooltip:{offset:10}},{}),n}),define("bui/chart/tooltip",["bui/common","bui/graphic","bui/chart/plotitem"],function(e){function i(e,t){return e>t?t:e}function s(e,t){return e>t?e:t}var t=e("bui/common"),n=e("bui/chart/plotitem"),r=e("bui/graphic").Util,o=function(e){o.superclass.constructor.call(this,e)};return o.ATTRS={zIndex:{value:10},elCls:{value:"x-chart-tootip"},crosshairs:{value:!1},plotRange:{},shared:{value:!1},offset:{value:0},shadow:{},title:{value:{"font-size":"10","text-anchor":"start",x:5,y:15}},name:{value:{"font-size":"12","text-anchor":"start"}},value:{value:{"font-size":"12","font-weight":"bold","text-anchor":"start"}},border:{value:{x:0,y:0,r:3,fill:"#fff","fill-opacity":.85}},animate:{value:!0},duration:{value:100},pointRenderer:{},valueSuffix:{value:""},visible:{value:!1},items:[]},t.extend(o,n),t.augment(o,{renderUI:function(){var e=this;o.superclass.renderUI.call(e),e._renderBorer(),e._renderText(),e._renderItemGroup(),e._renderCrossLine()},_renderBorer:function(){var e=this,t=e.getBBox(),n=e.addShape("rect",e.get("border"));e.set("borderShape",n)},_renderText:function(){var e=this,t=e.get("title");e.setTitle(t.text)},_renderItemGroup:function(){var e=this,t=e.get("items"),n=e.addGroup({x:8,y:30});e.set("textGroup",n),t&&e.setItems(t)},_renderCrossLine:function(){var e=this,t=e.get("crosshairs"),n,r=e.get("plotRange");t&&(n=e.get("parent").addShape({type:"line",visible:!1,zIndex:3,attrs:{stroke:"#C0C0C0",x1:0,y1:r.bl.y,x2:0,y2:r.tl.y}}),e.set("crossShape",n))},setTitle:function(e){var t=this,n=t.get("titleShape"),r=t.get("title"),i;n||(r.text=e||"",n=t.addShape("text",r),t.set("titleShape",n)),n.attr("text",e)},getInnerBox:function(){var e=this,t=e.get("textGroup"),n=e.get("titleShape"),r=t.getBBox(),i={},s=r.width;if(n){var o=n.getBBox();s=Math.max(s,o.width)}return i.width=r.x+s+8,i.height=r.height+r.y+10,i},setColor:function(e){var t=this,n=t.get("borderShape");n.attr("stroke",e)},show:function(){var e=this,t=e.get("crossShape"),n=e.get("hideHandler");n&&clearTimeout(n),o.superclass.show.call(e),t&&t.show()},hide:function(){var e=this,t=e.get("crossShape"),n=setTimeout(function(){o.superclass.hide.call(e),e.set("hideHandler",null)},e.get("duration"));e.set("hideHandler",n),t&&t.hide()},setPosition:function(e,t){var n=this,i=n.get("plotRange"),o=n.get("offset"),u=n.get("crossShape"),a=n.getBBox(),f=!0,l=n.get("animate"),c=e,h=t;e=e-a.width-o,t-=a.height,i&&(i.isInRange(e,t)||(i.isInVertical(t)||(t=i.tl.y),i.isInHorizontal(e)||(e=s(i.tl.x,c)+o,f=!1)));if(n.get("x")!=e||n.get("y")!=t)l&&r.svg&&n.get("visible")&&n.animate({x:e,y:t},n.get("duration")),n.move(e,t),u&&(f?u.attr("transform","t"+c+" 0"):u.attr("transform","t"+(e-o)+" 0"))},resetBorder:function(){var e=this,t=e.getInnerBox(),n=e.get("borderShape");n.attr({width:t.width,height:t.height})},addItem:function(e,n){function d(e,n){var r=t.merge(u,{x:c,y:a,text:e},n);return s.addShape("text",r)}var r=this,i=r.get("textGroup"),s=i.addGroup(),o=r.get("name"),u=r.get("value"),a=n*16,f;f=t.merge(o,{x:0,y:a,text:e.name+":",fill:e.color});var l=s.addShape("text",f),c=l.getBBox().width+10,h=r.get("valueSuffix"),p;t.isArray(e.value)?t.each(e.value,function(e){var n;t.isObject(e)?n=d(e.text,e):n=d(e),c+=n.getBBox().width}):(p=h?e.value+" "+h:e.value,d(p))},setItems:function(e){var n=this;n.clearItems(),t.each(e,function(e,t){n.addItem(e,t)}),e[0]&&n.setColor(e[0].color),n.resetBorder()},clearItems:function(){var e=this,t=e.get("textGroup");t.clear()},remove:function(){var e=this,t=e.get("crossShape");t&&t.remove(),o.superclass.remove(this)}}),o}),define("bui/chart/abstractaxis",function(e){var t=e("bui/common"),n=e("bui/chart/plotitem"),r=e("bui/chart/grid"),i=e("bui/graphic").Util,s=e("bui/chart/showlabels"),o="x-chart-axis",u=function(e){u.superclass.constructor.call(this,e)};return u.ATTRS={ticks:{},plotRange:{},line:{},tickLine:{},grid:{},labels:{},autoPaint:{value:!0},formatter:{}},t.extend(u,n),t.mixin(u,[s]),t.augment(u,{beforeRenderUI:function(){u.superclass.beforeRenderUI.call(this),this.set("pointCache",[])},renderUI:function(){var e=this;u.superclass.renderUI.call(e),e.renderLabels(),e.get("title")&&e._renderTitle(),e.get("autoPaint")&&e.paint()},paint:function(){var e=this;e._drawLines(),e._renderTicks(),e._renderGrid()},_renderTitle:function(){},_renderGrid:function(){var e=this,t=e.get("grid"),n,i;if(!t)return;n=e.get("parent").addGroup(r,t),e.set("gridGroup",n)},isInAxis:function(e,t){var n=this,r=n.get("plotRange");return r&&r.isInRange(e,t)},getLinePath:function(){},getOffsetPoint:function(e){},getValue:function(e){},getSnapValue:function(e,t){var n=this,r=n.get("pointCache");return i.snapTo(r,e)},getTicksCount:function(){return this.get("ticks").length},getTickOffsetPoint:function(e){return this.getOffsetPoint(e)},getOffsetByIndex:function(e){},_drawLines:function(){var e=this,n=e.get("line"),r=e.get("ticks"),i;if(n){i=e.getLinePath(),n=t.mix({path:i},n);var s=e.addShape({type:"path",elCls:o+"-line",attrs:n});e.set("lineShape",s)}e._processTicks(r)},_processTicks:function(e,n){var r=this,i=r.get("pointCache"),s=r.get("labels");e=e||r.get("ticks"),t.each(e,function(e,t){var o=r.getTickOffsetPoint(t),u=r.getOffsetPoint(t),a=r.getOffsetByIndex(t);i.push(a),r.get("tickLine")&&r._addTickItem(o,a),r.get("grid")&&r._addGridItem(o),s&&(n?s.items.push({text:r.formatPoint(e),x:u.x,y:u.y}):r.addLabel(r.formatPoint(e),u,a))})},_renderTicks:function(){var e=this,n=e.get("tickItems"),r=e.get("tickLine"),i="",s=t.mix({},r);if(n){t.each(n,function(e){var n=t.substitute("M{x1} {y1}L{x2} {y2}",e);i+=n}),delete s.value,s.path=i;var u=e.addShape({type:"path",elCls:o+"-ticks",attrs:s});e.set("tickShape",u)}},_addTickItem:function(e,n){var r=this,i=r.get("tickItems"),s={x1:e.x,y1:e.y},o=r.getTickEnd(s,n);i||(i=[],r.set("tickItems",i)),t.mix(s,o),i.push(s)},getTickEnd:function(e,t){},formatPoint:function(e){var t=this,n=t.get("formatter");return n&&(e=n.call(this,e)),e},_addGridItem:function(e){var n=this,r=n.get("grid"),i=n.get("plotRange"),s={},o;r.items||(r.items=[]),o=n.getGridItemCfg(e),t.mix(s,o),r.items.push(s)},getGridItemCfg:function(e){},remove:function(){var e=this,t=e.get("gridGroup"),n=e.get("labelsGroup");t&&t.remove(),e.removeLabels(),u.superclass.remove.call(this)}}),u}),define("bui/chart/baseaxis",["bui/common","bui/graphic","bui/chart/abstractaxis"],function(e){function s(e,t,n){if(t>n){var r=n;n=t,t=r}return e>=t&&e<=n}function o(e){o.superclass.constructor.call(this,e)}var t=e("bui/common"),n=e("bui/chart/abstractaxis"),r=e("bui/graphic").Util,i="x-chart-axis";return o.ATTRS={zIndex:{value:4},x:{},y:{},start:{},end:{},tickOffset:{value:0},elCls:{value:i},position:{value:"bottom"},line:{value:{"stroke-width":1,stroke:"#C0D0E0"}},tickLine:{value:{"stroke-width":1,stroke:"#C0D0E0",value:5}}},t.extend(o,n),t.augment(o,{beforeRenderUI:function(){var e=this,t;o.superclass.beforeRenderUI.call(e),t=e.get("plotRange");if(t){var n=t.start,r=e.get("position"),i={};e.isVertical()?r=="left"?(i.y=t.end.y,i.x=n.x):(n={},i=t.end,n.x=t.end.x,n.y=t.start.y):(i.x=t.end.x,i.y=n.y),e.set("start",n),e.set("end",i)}e.set("indexCache",{}),e.set("pointCache",[])},change:function(e){var t=this;t.isChange(e.ticks)&&(t._clearTicksInfo(),t.changeInfo(e),t._processTicks(null,!0),t._changeTicks(),t._changeGrid(),t.resetLabels())},isChange:function(e){var n=this,r=n.get("ticks");return!t.Array.equals(e,r)},changeInfo:function(e){var t=this;t.set("ticks",e.ticks)},_clearTicksInfo:function(){var e=this,t=e.get("grid"),n=e.get("labels");e.set("pointCache",[]),e.set("indexCache",[]),e.set("tickItems",[]),t&&(t.items=[]),n&&(n.items=[])},paint:function(){var e=this;e._drawLines(),e._renderTicks(),e._renderGrid()},isVertical:function(){var e=this,t=e.get("isVertical"),n;return t!=null?t:(n=e.get("position"),n=="bottom"||n=="top"?t=!1:t=!0,e.set("isVertical",t),t)},getOffset:function(e){var n=this,r=n.get("ticks"),i=t.Array.indexOf(e,r);return n.getOffsetByIndex(i)},getStartOffset:function(){return this._getStartCoord()},getEndOffset:function(){return this._getEndCoord()},getValue:function(e){var t=this,n=t._getStartCoord(),r=t._getEndCoord();return e<n||e>r?NaN:t.parseOffsetValue(e)},getStartValue:function(){var e=this,t=e.get("ticks");return t[0]},getEndValue:function(){var e=this,t=e.get("ticks");return t[t.length-1]},getSnapIndex:function(e){var n=this,i=n.get("pointCache"),s=r.snapTo(i,e);return t.Array.indexOf(s,i)},_appendEndOffset:function(e){var t=this,n=t.get("tickOffset"),r;return n&&(r=t._getDirectFactor(),e==0?e+=n*r:e>0?e+=n:e-=n),e},getOffsetByIndex:function(e){var t=this,n=t._getLength(),r=t.get("ticks"),i=r.length,s=n/(i-1)*e;return t._appendEndOffset(s)+t._getStartCoord()},getOffsetPoint:function(e,t){var n=this,r=n._getOrthoCoord(),i=n.get("indexCache");return t||(i[e]!==undefined?t=i[e]:(t=n.getOffsetByIndex(e),i[e]=t)),n.isVertical()?{x:r,y:t}:{x:t,y:r}},getTickOffsetPoint:function(e){return this.getOffsetPoint(e)},_getStartCoord:function(){var e=this,t=e.get("start");return e.isVertical()?t.y:t.x},_getOrthoCoord:function(){var e=this,t=e.get("start");return e.isVertical()?t.x:t.y},_getEndCoord:function(){var e=this,t=e.get("end");return e.isVertical()?t.y:t.x},_getMiddleCoord:function(){var e=this,t=e._getStartCoord(),n=e._getLength();return t+e._appendEndOffset(n/2)},getLength:function(){return Math.abs(this._getLength())},getTickAvgLength:function(){var e=this,t=e.get("ticks");return e.getLength()/(t.length-1)},_getLength:function(){var e=this,t=e.get("start"),n=e.get("tickOffset"),r=e.get("end"),i;return e.isVertical()?i=r.y-t.y:i=r.x-t.x,i>0?i-=n*2:i+=n*2,i},getLinePath:function(){var e=this,t=e.get("start"),n=e.get("end"),r=[];return r.push(["M",t.x,t.y]),r.push(["L",n.x,n.y]),r},getTickEnd:function(e){var t=this,n=t.get("tickLine"),r=t._getAlignFactor(),i=n.value,s={};return t.isVertical()?(s.x2=e.x1+i*r,s.y2=e.y1):(s.x2=e.x1,s.y2=e.y1+i*r),s},_changeTicks:function(){var e=this,n=e.get("tickShape"),i=e.get("tickItems"),s="";if(!n)return;t.each(i,function(e){var n=t.substitute("M{x1} {y1}L{x2} {y2}",e);s+=n}),r.animPath(n,s,2)},_getDirectFactor:function(){var e=this,t=e.get("directfactor"),n,r,i;return t?t:(t=1,n=e.get("position"),r=e.get("start"),i=e.get("end"),n=="bottom"||n=="top"?r.x>i.x&&(t=-1):r.y>i.y&&(t=-1),e.set("directfactor",t),t)},_getAlignFactor:function(){var e=this,t=e.get("factor"),n;return t?t:(n=e.get("position"),n=="bottom"||n=="right"?t=1:t=-1,e.set("factor",t),t)},_renderTitle:function(){var e=this,n=e.get("title"),r=e._getMiddleCoord(),s=e.getOffsetPoint(null,r),o=t.mix({},n);n.text&&(o.x=s.x+(n.x||0),o.y=s.y+(n.y||0),e.addShape({type:"label",elCls:i+"-title",attrs:o}))},getGridItemCfg:function(e){var t=this,n={},r=t.get("plotRange");return n.x1=e.x,n.y1=e.y,t.isVertical()?(n.y2=n.y1,n.x2=r.end.x):(n.x2=n.x1,n.y2=r.end.y),n},_changeGrid:function(){var e=this,t=e.get("grid"),n;if(!t)return;n=e.get("gridGroup"),n&&n.change(t.items)},remove:function(){var e=this,t=e.get("gridGroup"),n=e.get("labelsGroup");t&&t.remove(),e.removeLabels(),o.superclass.remove.call(this)}}),o}),define("bui/chart/axis/auto",["bui/graphic"],function(e){function u(e){return e==null}function a(e){var t=1;if(e<1e-6)return t;while(e>10)t*=10,e/=10;while(e<1)t/=10,e*=10;return t}function f(e,t,i){i=i||r;var s=i==r?!1:!0,o=1;e<0&&(o=-1),e*=o;var u=a(e);return o*=u,e/=u,s?e=l(i,e):t&&o>0?e=n.snapFloor(i,e):e=n.snapCeiling(i,e),e*o}function l(e,t){var n=t,r=t,i=t;for(var s=1;s<e.length;s++){var o=e[s];if(o>t){n=o;break}r=o}return Math.abs(r-t)<Math.abs(n-t)?i=r:i=n,i}function c(e,t,n){if(n)var r=Math.ceil(e/t,10);else var r=Math.floor(e/t,10);return r*t}function h(e,t){var n=t.toString(),r=n.indexOf(".");if(r==-1)return e;var i=n.substr(r+1).length;return parseFloat(e.toFixed(i))}function p(e){var t=e[0],n=e[0],r,i=e[0],s=e.length,o=0,r;for(var u=1;u<s;u++){var a=e[u];t<a&&(t=a),n>a&&(n=a),i+=a}r=i/s;for(var u=0;u<s;u++)o+=Math.abs(e[u]-r);return o/=s,n==t&&(n>0?n=0:t=0),{max:t,min:n,avg:r,deviation:o}}function d(e,n,r){var i=[];return t.isArray(e[0])?r?t.each(e[0],function(t,n){var r=t;for(var s=1;s<e.length;s++)r+=e[s][n];i.push(r)}):t.each(e,function(e){i=i.concat(e)}):i=e,n&&(i=$.map(i,n)),p(i)}function b(e){return e=new Date(e),t.Date.getDate(e).getTime()}function w(e){e=new Date(e);var n=t.Date.getDate(e);return t.Date.isDateEquals(e,n)||(n=t.Date.addDay(1,n)),n.getTime()}function E(e){return(new Date(e)).getFullYear()}function S(e){return(new Date(e,0,1)).getTime()}function x(e){return(new Date(e)).getMonth()}function T(e,t){var n=E(e),r=E(t),i=x(e),s=x(t);return(r-n)*12+(s-i)%12}function N(e,t){return(new Date(e,t,1)).getTime()}function C(e,t){return Math.ceil((t-e)/y)}function k(e,t){return Math.ceil((t-e)/g)}function L(e,t){return Math.ceil((t-e)/60*1e3)}var t=e("bui/common"),n=e("bui/graphic").Util,r=[0,1,1.5,2,2.5,3,4,5,6,8,10],i=[0,1,2.5,5,10],s=5,o=7,v={};v.caculate=function(e,t){var n=e.min,r=e.max,a=e.data,l=e.interval,p=[],v=e.minCount||s,m=e.maxCount||o,g=(v+m)/2,y,b=!1;t&&(t!="none"&&(b=!0),t=="percent"&&(n=0,r=100,l=25));if(u(n)||u(r)||u(l)){var w=d(a,null,b);u(r)&&(r=w.max+.05*(w.max-w.min)),u(n)&&(n=w.min);if(u(l)){var E=(r-n)/g;w.deviation>E?l=f(E,!0,i):w.deviation?l=f(w.deviation,!0,i):l=f(E,!0,i),y=parseInt((r-n)/l,10),y>m&&(y=m),y<v&&(y=v),l=f((r-n)/y,!0,i),r=c(r,l,!0),n=c(n,l),y=(r-n)/l}}u(y)&&(y=(r-n)/l),n=h(n,l),u(n)||p.push(n);for(var S=1;S<=y;S++)p.push(h(l*S+n,l));return{min:n,max:h(r,l),interval:l,count:y,ticks:p,info:w}},v.Time={};var m=6e4,g=36e5,y=864e5;return v.Time.caculate=function(e){var n=e.min,r=e.max,i=e.data,s=e.interval,o=[],a;if(u(n)||u(r)||u(s)){var f=d(i,function(e){return t.isDate(e)&&(e=e.getTime()),t.isString(e)&&(e=e.replace(/-/ig,"/"),e=new Date(e)),e});u(r)&&(r=f.max),u(n)&&(n=f.min),r-n>y&&(n=b(n),r=w(r));if(r==n)throw"max not  equal to min";if(u(s)){var l=r-n,c=y,p=365*c,v,A;s=parseInt(l/(e.maxCount||8)),v=s/p;var O=E(n);if(v>.51){A=Math.ceil(v),s=A*p;var M=E(r);for(var _=O;_<M+A;_+=A)o.push(S(_));s=null}else if(v>.0834){var A=E(n),D=Math.floor(v/.0834),P=x(n),H=T(n,r);for(var _=0;_<=H+D;_+=D)o.push(N(O,_+P));s=null}else if(s>c){var B=new Date(n),A=B.getFullYear(),D=B.getMonth(n),j=B.getDate(),F=Math.ceil(s/c),I=C(n,r);s=F*c;for(var _=0;_<=I+F;_+=F)o.push((new Date(A,D,j+_)).getTime())}else if(s>g){var B=new Date(n),A=B.getFullYear(),D=B.getMonth(n),F=B.getDate(),q=B.getHours(),R=Math.ceil(s/g),U=k(n,r);s=R*g;for(var _=0;_<=U+R;_+=R)o.push((new Date(A,D,F,q+_)).getTime())}else if(s>m){var z=L(n,r),W=Math.ceil(s/m);s=W*m;for(var _=0;_<=z+W;_+=W)o.push(n+_*m)}else{s<1e3&&s==1e3,n=Math.floor(n/1e3)*1e3;var X=Math.ceil((r-n)/1e3),V=Math.ceil(s/1e3);s=V*1e3;for(var _=0;_<X+V;_+=V)o.push(n+_*1e3)}}}if(!o.length){n=Math.floor(n/1e3)*1e3,r=Math.ceil(r/1e3)*1e3;var a=(r-n)/s;for(var _=0;_<=a;_++)o.push(h(s*_+n,s))}return{max:r,min:n,interval:s,ticks:o,count:o.length}},v}),define("bui/chart/numberaxis",["bui/chart/baseaxis","bui/common","bui/graphic"],function(e){function a(e){a.superclass.constructor.call(this,e)}var t=e("bui/common"),n=e("bui/chart/baseaxis"),r=e("bui/graphic").Util,i=["k","m","g","t"],s=NaN,o=r.snapFloor,u=r.snapCeiling;return t.extend(a,n),a.ATTRS={min:{},max:{},tickInterval:{},type:{value:"number"},formatter:{value:function(e){if(e==null||isNaN(e))return"";if(e<1e3)return e;var t=this.get("tickInterval");if(t%1e3!==0)return e;var n=1e3;for(var r=1;r<=i.length;r++){if(e>=n&&e<n*1e3)return e/n+i[r-1];n*=1e3}return e/1e12+"t"}}},t.augment(a,{beforeRenderUI:function(){var e=this;a.superclass.beforeRenderUI.call(e);if(!e.get("ticks")){var t=e._getTicks(e.get("max"),e.get("min"),e.get("tickInterval"));e.set("ticks",t)}},_getTicks:function(e,t,n){var r=[],i=(e-t)/n,s;r.push(t);for(var o=1;o<=i;o++)s=n*o+t,r.push(s);return r},changeInfo:function(e){var t=this;e.interval&&(e.tickInterval=e.interval);if(e.ticks)t.set("ticks",e.ticks);else{var n=t._getTicks(e.max,e.min,e.tickInterval);t.set("ticks",n)}e.tickInterval&&t.set("tickInterval",e.tickInterval)},getOffset:function(e){e=parseFloat(e);var t=this,n=t.getRelativeOffset(e);return t._appendEndOffset(n)+t._getStartCoord()},getValue:function(e){var n=this,r=n._getStartCoord(),i=n._getEndCoord(),s,a,f,l,c,h;return e<r||e>i?NaN:(s=n.get("pointCache"),a=o(s,e),f=t.Array.indexOf(a,s),h=n.get("ticks"),c=n.get("tickInterval"),avg=n._getAvgLength(h.length),a==e?h[f]:c?h[f]+(e-a)/avg*c:(l=u(s,e),h[f]+(e-a)/avg*(h[f+1]-h[f])))},_getAvgLength:function(e){var t=this,n=t._getLength();return n/(e-1)},getRelativeOffset:function(e){var n=this,r=n.get("ticks"),i=t.Array.indexOf(e,r),a=n.get("tickInterval"),f,l,c=n._getAvgLength(r.length),h;return i!==-1?c*i:(f=o(r,e),isNaN(f)?s:(i=t.Array.indexOf(f,r),h=c*i,a?h+=(e-f)/a*c:(l=u(r,e),h+=(e-f)/(l-f)*c),h))}}),a}),define("bui/chart/grid",["bui/common","bui/chart/plotitem"],function(e){function s(e,t,n){var r=t.get(e);return r||(r=n,t.set(e,r)),r}function o(e,n){var r="",i=t.mix({},n);return t.each(e,function(e){var n=t.substitute("M{x1} {y1}L{x2} {y2}",e);r+=n}),i.path=r,i}function u(e){u.superclass.constructor.call(this,e)}var t=e("bui/common"),n=e("bui/chart/plotitem"),r=e("bui/graphic").Util,i="x-chart-grid";return t.extend(u,n),u.ATTRS={zIndex:{value:1},elCls:{value:i},type:{value:"line"},line:{},minorLine:{},minorCount:{value:0},renderer:{},items:{},odd:{},even:{},animate:{value:!0},duration:{value:1e3}},t.augment(u,{renderUI:function(){var e=this;u.superclass.renderUI.call(e),e._drawLines()},_drawLines:function(){var e=this,t=e.get("line"),n=e.get("items");if(n){var r;e._precessItems(n),e._drawGridLines(n,t,i+"-line"),e.get("minorCount")&&e.drawMinorLines()}},_precessItems:function(e){var n=this,r=n.get("minorCount"),i=n.get("renderer"),s;t.each(e,function(e,t){i?i.call(this,e,t):r&&s&&n._addMonorItem(e,s),s&&(n.get("odd")||n.get("even"))&&n._drawOddEven(e,s,t),s=e})},change:function(e){var t=this;t.set("items",e),t._clearPre(),t._precessItems(e),t._changeGridLines(e,i+"-line",!0),t._changeMinorLinses()},_clearPre:function(){var e=this,n;e.get("minorCount")&&e.set("minorItems",[]),n=e.findBy(function(e){var t=e.get("elCls");return t==i+"-line"||t==i+"-minor"?!1:!0}),t.each(n,function(e){e.remove()})},_isVertical:function(e){return e.x1==e.x2?!0:!1},_drawGridLines:function(e,t,n){var r=this,i=r._linesToPath(e,t),s=r.addShape({type:"path",elCls:n,attrs:i});r.set("gridLine"+n,s)},_changeGridLines:function(e,t,n){var s=this,o=s.get("gridLine"+t);if(o){var u=s._linesToPath(e,{});n?r.animPath(o,u.path,2):o.attr("path",u.path)}else if(e&&e.length){var a
;t==i+"-line"?a=s.get("line"):a=s.get("minorLine"),s._drawGridLines(e,a,t)}},_linesToPath:function(e,n){var r=this,i=[],s=r.get("type"),u;return s=="line"?e.length==0?"":o(e,n):(u=t.mix({},n),t.each(e,function(e){i=i.concat(r._getMultiplePath(e,s))}),u.path=i,u)},_getMultiplePath:function(e,n){var r=this,i=e.points,s=[];if(n=="polygon")t.each(i,function(e,t){t==0?s.push(["M",e.x,e.y]):s.push(["L",e.x,e.y])}),s.push(["L",i[0].x,i[0].y]),s.push(["z"]);else{var o=e.center.x,u=e.center.y,a=e.r,f=e.r;a==0?s=[]:s=[["M",o,u],["m",0,-f],["a",a,f,0,1,1,0,2*f],["a",a,f,0,1,1,0,-2*f]]}return s},_drawOddEven:function(e,t,n){var r=this,s=r.get("odd"),o=r.get("even"),u,a;n%2==0?o&&(a=r._getBackItem(t,e,o),u="even"):s&&(a=r._getBackItem(t,e,s),u="odd"),a&&r.addShape({type:"path",elCls:i+"-"+u,attrs:a})},_getBackItem:function(e,n,r){var i=this,s=t.substitute("M {x1} {y1} L{x2} {y2}",e);return s+=t.substitute("L{x2} {y2} L{x1} {y1}Z",n),r=t.merge(r,{path:s}),r},_getMinorItem:function(e,t,n,r){var i=this,s=i._isVertical(e,t),o=s?"x":"y",u=s?"y":"x",a=t[o+"1"]-e[o+"1"],f=a/(r+1),l={};return l[o+"1"]=l[o+"2"]=(n+1)*f+e[o+"1"],l[u+"1"]=e[u+"1"],l[u+"2"]=e[u+"2"],l},_addMonorItem:function(e,t){var n=this,r=s("minorItems",n,[]),i=n.get("minorCount");if(i)for(var o=0;o<i;o++){var u=n._getMinorItem(t,e,o,i);r.push(u)}},drawMinorLines:function(){var e=this,t=e.get("minorLine"),n=e.get("minorItems");e._drawGridLines(n,t,i+"-minor")},_changeMinorLinses:function(){var e=this,t=e.get("minorItems");e._changeGridLines(t,i+"-minor")}}),u}),define("bui/chart/circleaxis",["bui/common","bui/graphic","bui/chart/abstractaxis"],function(e){function s(e,t,n){var r=e.getCenter(),s={};return s.x=r.x+t*Math.sin(n*i),s.y=r.y-t*Math.cos(n*i),s}var t=e("bui/common"),n=e("bui/graphic").Util,r=e("bui/chart/abstractaxis"),i=Math.PI/180,o=function(e){o.superclass.constructor.call(this,e)};return t.extend(o,r),o.ATTRS={type:{value:"circle"},startAngle:{value:0},endAngle:{value:360},margin:{value:20},radius:{},tickInterval:{},grid:{shared:!1,value:{line:{"stroke-width":1,stroke:"#C0D0E0"}}},formatter:{value:function(e){var n=this,r=n.get("ticks");if(t.isNumber(e)){var i=t.Array.indexOf(e,r);if(i==-1){var s=n.getTickAvgAngle();i=parseInt(e/s,10),e=r[i]}}return e}}},t.augment(o,{beforeRenderUI:function(){var e=this;o.superclass.beforeRenderUI.call(e);var t=e.get("tickInterval"),n=e.get("ticks"),r=e.get("startAngle"),i=e.get("endAngle"),s;if(t&&!n){n=[],s=(i-r)/t;for(var u=0;u<s;u++)n.push(r+t*u);e.set("ticks",n)}},getCenter:function(){var e=this,t=e.get("plotRange");return t.cc},getRadius:function(){var e=this,t=e.get("radius"),n=e.get("plotRange");return t||(t=Math.min(n.getWidth(),n.getHeight())/2-e.get("margin"),e.set("radius",t)),t},getTickAvgAngle:function(){var e=this,t=e.get("ticks"),n=e.get("startAngle"),r=e.get("endAngle");return(r-n)/t.length},getLinePath:function(){var e=this,t=e.getCenter(),n=t.x,r=t.y,i=e.getRadius(),s=i;return[["M",n,r],["m",0,-s],["a",i,s,0,1,1,0,2*s],["a",i,s,0,1,1,0,-2*s],["z"]]},getOffsetPoint:function(e){var t=this,n=t.getOffsetByIndex(e),r=t.getRadius();return t.getCirclePoint(n,r)},getCirclePoint:function(e,t){return t==null&&(t=this.getRadius()),s(this,t,e)},getDistance:function(e,t){var n=this,r=n.getCenter();return Math.sqrt(Math.pow(e-r.x,2)+Math.pow(t-r.y,2))},getCircleAngle:function(e,t){var n=this,r=n.getCenter(),i=n.getDistance(e,t),s=Math.asin(Math.abs(e-r.x)/i)/Math.PI*180;return e>=r.x&&t<=r.y?s:e>=r.x&&t>=r.y?180-s:e<=r.x&&t>=r.y?s+180:360-s},getOffsetByIndex:function(e){var t=this,n=t.get("ticks"),r=n.length,i=t.get("startAngle"),s=t.get("endAngle");return i+(s-i)/r*e},getValue:function(e){return this.getSnapValue(e)},getSnapValue:function(e,t){var r=this,i=r.get("pointCache");return n.snapFloor(i,e)},getGridItemCfg:function(e){var t=this,n=t.getCenter();return{x1:n.x,y1:n.y,x2:e.x,y2:e.y}},addLabel:function(e,t,n){var r=this,i=r.get("margin"),s=r.getRadius();t=r.getCirclePoint(n,s+i),o.superclass.addLabel.call(r,e,t)},getTickEnd:function(e,t){var n=this,r=n.getRadius(),i=n.get("tickLine"),s=i.value,o=n.getCirclePoint(t,r+s);return{x2:o.x,y2:o.y}}}),o}),define("bui/chart/radiusaxis",["bui/common","bui/chart/numberaxis"],function(e){var t=e("bui/common"),n=e("bui/chart/numberaxis"),r=function(e){r.superclass.constructor.call(this,e)};return r.ATTRS={circle:{},position:{value:"left"},type:{value:"radius"}},t.extend(r,n),t.augment(r,{beforeRenderUI:function(){r.superclass.beforeRenderUI.call(this);var e=this,t=e.get("circle");e.set("start",t.getCenter()),e.set("end",t.getCirclePoint(0))},getGridItemCfg:function(e){var t=this,n={},r=[],i=t.get("circle"),s=i.getCenter(),o=i.getTicksCount(),u=Math.abs(e.y-s.y);for(var a=0;a<o;a++){var f=i.getOffsetByIndex(a),l=i.getCirclePoint(f,u);r.push(l)}return n.points=r,n.r=u,n.center=s,n},getPointByAngle:function(e,t){var n=this,r=n.get("circle"),i=r.getCenter(),s=n.getOffset(t);return r.getCirclePoint(e,Math.abs(s-i.y))}}),r}),define("bui/chart/timeaxis",["bui/common","bui/chart/numberaxis"],function(e){function r(e){if(e instanceof Date)return e.getTime();if(t.isNumber(e))return e;var n=e;return t.isString(e)&&(n=e.replace("-","/"),n=(new Date(n)).getTime()),n}var t=e("bui/common"),n=e("bui/chart/numberaxis"),i=function(e){i.superclass.constructor.call(this,e)};return i.ATTRS={startDate:{},dateFormat:{},endDate:{}},t.extend(i,n),t.augment(i,{beforeRenderUI:function(){var e=this,t=r(e.get("startDate")),n=r(e.get("endDate"));t&&!e.get("min")&&e.set("min",t),n&&!e.get("max")&&e.set("max",n),i.superclass.beforeRenderUI.call(e)}}),i}),define("bui/chart/categoryaxis",["bui/chart/baseaxis","bui/common"],function(e){function r(e){r.superclass.constructor.call(this,e)}var t=e("bui/common"),n=e("bui/chart/baseaxis");return t.extend(r,n),r.ATTRS={categories:{},type:{value:"category"}},t.augment(r,{beforeRenderUI:function(){var e=this;r.superclass.beforeRenderUI.call(e);if(!e.get("ticks")){var t=e.get("categories"),n=[];n=n.concat(t),n.push(" "),e.set("ticks",n)}},changeInfo:function(e){var t=this,n=[];n=n.concat(e.categories),n.length&&n.push(" "),t.set("categories",e.categories),t.set("ticks",n)},getOffsetByIndex:function(e){var t=this,n=t._getAvgLength(),r=n*e;return r>=0?r+=n/2:r-=n/2,t._appendEndOffset(r)+t._getStartCoord()},getValue:function(e){var t=this,n=t.getSnapIndex(e),r=t.get("categories");return r[n]},changeAxis:function(e){},_getAvgLength:function(){var e=this,t=e._getLength(),n=e.get("ticks"),r=n.length,i=t/(r-1);return i},getTickOffsetPoint:function(e){var t=this,n=t._getOrthoCoord(),r=t._getAvgLength(),i=t.getOffsetByIndex(e);return i>=0?i-=r/2:i+=r/2,t.isVertical()?{x:n,y:i}:{x:i,y:n}}}),r}),define("bui/chart/axis",["bui/common","bui/chart/baseaxis","bui/chart/categoryaxis","bui/chart/numberaxis","bui/chart/timeaxis","bui/chart/circleaxis","bui/chart/radiusaxis"],function(e){var t=e("bui/common"),n=e("bui/chart/baseaxis");return n.Category=e("bui/chart/categoryaxis"),n.Number=e("bui/chart/numberaxis"),n.Time=e("bui/chart/timeaxis"),n.Auto=e("bui/chart/axis/auto"),n.Circle=e("bui/chart/circleaxis"),n.Radius=e("bui/chart/radiusaxis"),n}),define("bui/chart/baseseries",["bui/chart/plotitem","bui/chart/showlabels","bui/chart/markers","bui/chart/actived"],function(e){var t=e("bui/common"),n=e("bui/chart/plotitem"),r=e("bui/chart/showlabels"),i=e("bui/chart/actived"),s=e("bui/chart/markers"),o=function(e){o.superclass.constructor.call(this,e)};return t.extend(o,n),t.mixin(o,[r,i]),o.ATTRS={zIndex:{value:5},markers:{},labels:{},animate:{value:!1},duration:{value:1e3},changeDuration:{value:400},inLegend:{value:!0},data:{value:[],shared:!1},autoPaint:{value:!0},enableMouseTracking:{value:!0},stickyTracking:{value:!0},xField:{value:"x"},yField:{value:"y"},itemName:{value:"seriesItem"},groupName:{value:"series"}},t.augment(o,{renderUI:function(){var e=this;o.superclass.renderUI.call(e),e.processColor(),e.renderLabels(),e.renderMarkers(),e.get("autoPaint")&&e.paint()},bindUI:function(){var e=this;o.superclass.bindUI.call(e);if(e.get("enableMouseTracking")){e.onMouseOver();var t=e.get("parent");e.on("mouseover",function(){t.setActivedItem&&(t.isItemActived(e)||t.setActivedItem(e))})}e.get("stickyTracking")||e.onMouseOut()},changeData:function(e,t){var n=this,r=n.get("data"),i=n.get("parent");e!=r&&n.set("data",e),t&&(i?i.repaint():n.get("visible")&&n.repaint())},addPoint:function(e,t,n){var r=this,i=r.get("data");i.push(e),t&&(i.shift(),n&&i.unshift(i[0])),r.changeData(i,n),t&&setTimeout(function(){i.shift(),r.set("points",null),n&&(r.shiftPoint(),r.changeShapes(r.getPoints(),!1))},800)},shiftPoint:function(){var e=this,t=e.get("markersGroup"),n=e.get("labelsGroup"),r=e.get("xAxis"),i;t&&(i=t.getChildAt(0),i&&i.remove()),n&&(i=n.getChildAt(0),i&&i.remove());if(r){var s=r.get("labelsGroup");s&&(i=s.getChildAt(0),i&&i.remove())}},getData:function(e){},onMouseOver:function(e){},onMouseOut:function(e){},onStickyTracking:function(e){},processColor:function(){},getTrackingInfo:function(e){},getPoints:function(){var e=this,t=e.get("points");return t||(t=e._getPoints(),e.set("points",t)),t},_getPoints:function(){var e=this,n=e.get("data"),r=e.get("xField"),i=e.get("yField"),s=[];return t.each(n,function(n,o){var u;if(t.isObject(n)){var a=n[r],f=n[i];a==null?u=e.getPointByIndex(f,o):u=e.getPointByValue(a,f),u.obj=n}else t.isArray(n)?(u=e.getPointByValue(n[0],n[1]),u.arr=n):u=e.getPointByIndex(n,o);e.processPoint(u,o),s.push(u)}),s},processPoint:function(e,t){},getPointByObject:function(e){},getPointByIndex:function(e,t){},getPointByValue:function(e,t){},getTipItem:function(e){return e.value},findPointByValue:function(e){var n=this,r=n.get("points"),i;return t.each(r,function(t){if(n.snapEqual(t.xValue,e)&&t.value!=null)return i=t,!1}),i},snapEqual:function(e,t){return e==t},draw:function(e){},paint:function(){var e=this,t=e.getPoints();if(e.get("isPaint")||!e.get("data").length)return;e.set("painting",!0),e.draw(t,function(){e.sort()}),e.set("isPaint",!0),e.set("painting",!1)},repaint:function(){var e=this,n=e.get("labels"),r=e.get("markers"),i;e.set("points",null);if(!e.get("isPaint")&&!e.get("painting")){e.paint();return}i=e.getPoints(),n&&(n.items=[]),r&&(r.items=[]),e.changeShapes(i),t.each(i,function(e){if(n){var t={};t.text=e.value,t.x=e.x,t.y=e.y,n.items.push(t)}r&&r.items.push(e)}),e._changeMarkers(),e._changeLabels()},changeShapes:function(e){},addMarker:function(e){var n=this,r=n.get("markersGroup"),i={},s;return r&&(i.x=e.x,i.y=e.y,e.obj&&e.obj.marker&&t.mix(i,e.obj.marker),s=r.addMarker(i),s.set("point",e)),s},renderMarkers:function(){var e=this,t=e.get("markers"),n;t&&(t||(t.items=[]),n=e.addGroup(s,t),e.set("markersGroup",n))},_changeMarkers:function(){var e=this,t=e.get("markers"),n;t&&(n=e.get("markersGroup"),n.change(t.items))},_changeLabels:function(){this.resetLabels()},removeMarkers:function(){var e=this,t=e.get("markersGroup");t&&t.remove()},getActiveAtrrs:function(){},getUnActiveAttrs:function(){},setActiveStatus:function(e){},remove:function(){var e=this;e.removeMarkers(),e.removeLabels(),o.superclass.remove.call(this)}}),o}),define("bui/chart/series/stacked",function(e){var t=e("bui/common"),n=function(){};return n.ATTRS={stackType:{value:"none"}},t.augment(n,{processStackedPoint:function(e,t){var n=this,r=n.getVisiblePrev();if(r){var i=r.getPoints()[t],s=n.getBaseValue();if(!n.isInCircle())e.y=e.y+i.y-s;else{var o=n.get("xAxis"),u=o.getDistance(e.x,e.y),a=i.r||o.getDistance(i.x,i.y),f;u=a+u,f=o.getCirclePoint(e.xValue,u),e.x=f.x,e.y=f.y,e.r=u,e.ir=a}e.lowY=i.y,e.lowX=i.x}},getStackedPercent:function(e,t){var n=this,r=n.get("parent").getStackedData(n.get("yAxis"),"yAxis"),i=r[t];return i?e/i:NaN},parseYValue:function(e){var n=this,r=n.get("stackType"),i=n.get("data"),s=t.Array.indexOf(e,i),o;return r=="percent"&&(o=n.getStackedPercent(e,s),e=o*100),e},getVisiblePrev:function(){var e=this,n=e.get("parent"),r=e.get("yAxis"),i=n.get("children"),s;return t.each(i,function(t,n){if(t==e)return!1;t.get("visible")&&t.get("yAxis")==r&&(s=t)}),s},getTipItem:function(e){var t=this,n=t.get("stackType");if(n=="percent"){var r=e.yValue||0;return[e.value,"\uff08"+r.toFixed(2)+"%\uff09"]}return e.value},isStacked:function(){var e=this,t=e.get("stackType");return t&&t!=="none"}}),n}),define("bui/chart/series/itemgroup",["bui/chart/baseseries"],function(e){var t=e("bui/common"),n=e("bui/chart/baseseries"),r=e("bui/graphic").Util,i=function(){};return i.ATTRS={item:{},group:{},allowPointSelect:{value:!1},cancelSelect:{value:!0}},t.extend(i,n),t.augment(i,{addItem:function(e,t){var n=this,r=n.get("group"),i;t==null&&(t=n.getItems().length),r||(r=n.addGroup(),n.set("group",r)),i=n.getItemCfg(e,t),n.get("animate")?i.path=n.pointToFactorPath(e,0):i.path=n.pointToPath(e);var s=r.addShape("path",i);return s.isSeriesItem=!0,s.set("point",e),s},bindItemClick:function(){var e=this,t=e.get("cancelSelect");e.on("click",function(n){var r=n.target,i=r.shape,s;i&&i.isSeriesItem&&(e.get("allowPointSelect")&&(s=i.get("selected"),t&&s?e.clearSelected(i):e.setSelected(i)),e.fireUpGroup("click",i))})},setSelected:function(e){var t=this;t.isSelected(e)||(t.clearSelected(),t.setItemSelected(e,!0),t.onSelected(e))},changePoints:function(e){var n=this,r=n.getItems(),i=n.get("animate");e=e||n.getPoints(),t.each(r,function(t,r){var s=e[r],o,u;s&&(o=t.get("point"),t.set("point",s),t.set("prePoint",o),i?n.animateItem(t,o):(u=n.pointToPath(s),t.attr("path",u)))});var s=e.length,o=r.length;for(var u=o;u<s;u++){var a=n.addItem(e[u],u);i&&n.animateItem(a,r[o-1].get("prePoint"))}for(var u=o-1;u>=s;u--){var f=r[u];f.remove()}},onSelected:function(e){this.fireUpGroup("selected",e)},onUnSelected:function(e){this.fireUpGroup("unselected",e)},clearSelected:function(e){var t=this;e=e||t.getSelected(),e&&(t.setItemSelected(e,!1),t.onUnSelected(e))},setItemSelected:function(e,t){},isSelected:function(e){return e&&e.get("selected")},getSelected:function(){var e=this,n=e.getItems(),r;return t.each(n,function(t){if(e.isSelected(t))return r=t,!1}),r},getItemCfg:function(e,n){var r=this,i=r.get("item"),s=e.obj,o={};return t.mix(o,i),s&&s.attrs&&t.mix(o,s.attrs),o},getItems:function(){var e=this.get("group");return e?e.get("children"):[]},animateItems:function(e){var n=this,i=n.getItems();r.animStep(n.get("duration"),function(e){t.each(i,function(t){var r=t.get("point"),i=n.pointToFactorPath(r,e);t.attr("path",i)})},e)},animateItem:function(e,t){var n=this,r=e.get("point"),i=n.pointToPath(r);e.animate({path:i},n.get("changeDuration"))},removeItem:function(e){var t=this;t.removeLabel(e),e.remove()},removeLabel:function(e){var t=e.get("label");t&&t.remove()},pointToFactorPath:function(e,t){},pointToPath:function(e){return this.pointToFactorPath(e,1)}}),i}),define("bui/chart/cartesianseries",["bui/chart/baseseries","bui/graphic"],function(e){function i(e){return t.isNumber(e)?e:(t.isString(e)?(e=e.replace(/'-'/ig,"/"),e=(new Date(e)).getTime()):t.isDate(e)&&(e=e.getTime()),e)}function s(e){s.superclass.constructor.call(this,e)}var t=e("bui/common"),n=e("bui/chart/baseseries"),r=e("bui/graphic").Util;return s.ATTRS={pointInterval:{},pointStart:{value:0},xAxis:{},yAxis:{},pointsCache:{shared:!1,value:{}}},t.extend(s,n),t.augment(s,{getPoint:function(e,n){var r=this,s=r.get("xAxis"),o=r.get("yAxis"),u=r.parseYValue(n),a={};return s.get("type")=="time"&&(e=i(e)),r.isInCircle()?a=o.getPointByAngle(e,u):(a.x=s.getOffset(e),a.y=o.getOffset(u)),t.mix(a,{yValue:u,xValue:e,value:n}),a},changeData:function(e,t){this.set("pointsCache",{}),s.superclass.changeData.call(this,e,t)},getPointByObject:function(e,t){var n=this,r=n.get("xField"),i=n.get("yField"),s=n.getPoint(e[r],e[i]);return s.value=e[i],s.xValue=e[r],s.yValue=n.parseYValue(e[i]),s.obj=e,s},getPointByValue:function(e,t){return this.getPoint(e,t)},parseYValue:function(e){return e},snapEqual:function(e,n){var r=this;if(t.isString(e))return e==n;var i=r.get("pointInterval");return i?Math.abs(e-n)<i/2:e==n},isInCircle:function(){return this.get("xAxis").get("type")=="circle"},getCircleCenter:function(){var e=this,t=e.get("xAxis"),n=null;return t.get("type")=="circle"&&(n=t.getCenter()),n},getCircle:function(){return this.isInCircle()?this.get("xAxis"):null},getData:function(e){var n=this,r=n.get("data"),i=n.get("pointsCache"),s=n.get("xAxis"),o=r[0],u=[],a=n.get("pointStart");e=e||"yAxis";if(i[e])return i[e];if(e!="xAxis"||a==null||s.get("type")=="time"&&a==0||!n.get("pointInterval")){var l=n.get("xField"),c=n.get("yField");t.each(r,function(n){if(t.isNumber(n)||t.isString(n))u.push(n);else if(t.isArray(n)){var r=e=="yAxis"?n[1]:n[0];u.push(r)}else if(n){var r=e=="yAxis"?n[c]:n[l];u.push(r)}})}else{var f=n.get("pointInterval");u.push(a),u.push(a+(r.length-1)*f)}return i[e]=u,u},getPointByIndex:function(e,t){var n=this,i=n.get("xAxis"),s=n.get("yAxis"),o,u=n.parseYValue(e),a=s.getOffset(u),f,l;if(i.get("type")=="number"||i.get("type")=="time"){var c=n.get("pointStart"),h=n.get("pointInterval");o=i.getOffset(c+h*t)}else o=i.getOffsetByIndex(t);return n.isInCircle()?n.getPoint(o,e):(f=i.getValue(o),h&&(f=r.tryFixed(f,h)),{x:o,y:a,xValue:f,yValue:u,value:e})},getTrackingInfo:function(e){var t=this,n=t.get("xAxis"),r;if(t.isInCircle()){var i=n.getCircleAngle(e.x,e.y);r=n.getValue(i)}else r=n.getValue(e.x);return t.findPointByValue(r)},getBaseValue:function(){var e=this,t=e.get("yAxis"),n=t.getOffset(0)||t.getStartOffset();return n}}),s}),define("bui/chart/lineseries",["bui/chart/cartesianseries","bui/graphic"],function(e){function i(e,t,n){e&&!e[t]&&(e[t]=n)}function s(e){s.superclass.constructor.call(this,e)}var t=e("bui/common"),n=e("bui/chart/cartesianseries"),r=e("bui/graphic").Util;return t.extend(s,n),s.ATTRS={type:{value:"line"},elCls:{value:"x-chart-line-series"},connectNulls:{value:!1},line:{},lineActived:{},tolerance:{value:20},smooth:{value:!1}},t.augment(s,{processColor:function(){var e=this,t=e.get("color");if(t){var n=e.get("line"),r=e.get("markers");i(n,"stroke",t),r&&(i(r.marker,"stroke",t),i(r.marker,"fill",t))}},onStickyTracking:function(e){var t=this,n=e.point,r=t.get("markersGroup"),i=t.getSnapMarker(n);r&&r.setActivedItem(i)},changeShapes:function(e,t){e=e||this.getPoints();var n=this,i=n.get("lineShape"),s=n.points2path(e);t==null&&(t=n.get("animate"));if(i)if(t){if(r.svg&&n.get("smooth")){var o=i.getPath();i.attr("path",s),s=i.attr("path"),i.attr("path",o)}r.animPath(i,s)}else i.attr("path",s)},draw:function(e,n){function h(){i.drawTracker(e),n&&n()}var i=this,s=i.get("animate"),o=i.get("duration"),u,a="";if(!s)a=i.points2path(e),u=i._createLine(a),t.each(e,function(e){i._drawPoint(e)}),i.drawInner(e),h();else{u=i._createLine(a);if(i.isInCircle())i.circleAnimate(e,u);else{var f=0,l=[],c=e.length;r.animStep(o,function(t){var n=f;f=parseInt(t*c,10),f>c-1&&(f=c-1);if(f!=n){l=e.slice(0,f+1),a=i.points2path(l),u.attr("path",a),i.drawInner(l);for(var r=n;r<f;r++)i._drawPoint(e[r])}t==1&&i._drawPoint(e[f])},h)}}},circleAnimate:function(e,n){var r=this,i=r.getCircle(),s=i.getCenter(),o=[],u=r.getBaseValue(),a;t.each(e,function(e){var n=t.mix({value:u},s);o.push(n),r._drawPoint(n)}),a=r.points2path(o),n.attr("path",a),r.drawInner(o),r.repaint()},drawInner:function(e){},_drawPoint:function(e){var t=this;t.get("markers")&&!t.get("markersGroup").get("single")&&t.addMarker(e),t.get("labels")&&t.addLabel(e.value,e)},_createLine:function(e){var n=this,r=n.get("line"),i=t.mix({},r);return i.path=e,lineShape=n.addShape("path",i),n.set("lineShape",lineShape),lineShape},drawTracker:function(e){var n=this,r=n.get("line"),i=n.get("tolerance"),s=n.points2tracker(e),o=t.mix({},r),u=Number(r["stroke-width"]),a;o["stroke-width"]=u+i,o["stroke-opacity"]=.001,o.path=s,a=n.addShape("path",o),n.set("trackerShape",a)},points2path:function(e){if(!e.length)return"";var n=this,r=n.get("smooth"),i=n.get("connectNulls"),s="",o,u;return e.length<=2&&(r=!1),t.each(e,function(e,n){if(e.value==null){if(i)return;u=""}else u=o==null||o.value==null?r?"M{x} {y} R":"M{x} {y}":r?" {x} {y}":"L{x} {y}";s+=t.substitute(u,e),o=e}),n.isInCircle()&&(s+="z"),s},points2tracker:function(e){if(!e.length)return"";var n=this,r=n.get("tolerance"),i=e[0],s="M"+(e[0].x-r)+" "+e[0].y;return t.each(e,function(e,n){var r="L{x} {y}";s+=t.substitute(r,e)}),n.isInCircle()&&(s+="z"),s},setActiveStatus:function(e){var t=this,n=t.get("line"),r=t.get("lineShape"),i=t.get("lineActived");if(e)i&&r.attr(i);else{n&&r.attr(n);var s=t.get("markersGroup");s&&s.clearActivedItem()}},getSnapMarker:function(e){var t=this,n=t.get("markersGroup"),r=null;if(n)if(t.isInCircle()){var i=t.getTrackingInfo(e);r=n.getSnapMarker(i)}else r=n.getSnapMarker(e.x);return r}}),s}),define("bui/chart/areaseries",["bui/common","bui/chart/lineseries","bui/graphic","bui/chart/series/stacked"],function(e){function o(e,t,n){e&&!e[t]&&(e[t]=n)}var t=e("bui/common"),n=e("bui/chart/lineseries"),r=e("bui/graphic").Util,i=e("bui/chart/series/stacked"),s=/^M.*(M).*$/,u=function(e){u.superclass.constructor.call(this,e)};return u.ATTRS={area:{shared:!1,value:{stroke:"","fill-opacity":"0.70"}}},t.extend(u,n),t.mixin(u,[i]),t.augment(u,{processColor:function(){u.superclass.processColor.call(this);var e=this,t=e.get("color"),n=e.get("area");o(n,"fill",t)},renderUI:function(){u.superclass.renderUI.call(this);var e=this,t=e.get("canvas"),n=e.get("markersGroup");n&&e.isStacked()&&$(n.get("node")).appendTo(t.get("node"))},hide:function(){u.superclass.hide.call(this);var e=this,t=e.get("markersGroup");t&&t.hide()},show:function(){u.superclass.show.call(this);var e=this,t=e.get("markersGroup");t&&t.show()},drawInner:function(e){var t=this,n=t.get("areaShape");if(!n)t.drawArea(e);else{var r=t._getAreaPath(e);n.attr("path",r)}},_getAreaPath:function(e){var t=this,n=t.get("stackType"),r;return n&&n!="none"?r=t.points2StackArea(e):r=t.points2area(e),r},changeShapes:function(){u.superclass.changeShapes.call(this);var e=this,t=e.get("areaShape"),n=e.getPoints(),i=e._getAreaPath(n);r.animPath(t,i)},drawArea:function(e){var n=this,r=n.get("area"),i=n.isStacked()?n.points2StackArea(e):n.points2area(e),s=t.mix({path:i},r),o;o=n.addShape("path",s),n.set("areaShape",o)},processPoint:function(e,t){var n=this,r=n.get("stackType");r&&r!="none"&&n.processStackedPoint(e,t)},points2StackArea:function(e){var t=this,n=e.length,r=t.getBaseValue(),i=e[0],s=e[n-1],o,u=t.isInCircle(),a="",f;if(n){f=t.getVisiblePrev(),o=t.points2path(e),a=o;if(f){var l=f.getPoints().slice(0,e.length),c=l[0],h=t.points2path(l.reverse());h=h.replace("M","L"),u?a=o+"L"+c.x+" "+c.y+h:a=o+h}else u||(a="M "+i.x+" "+r+o.replace("M","L"),a=a+"L "+s.x+" "+r+"");a&&!u&&(a+="z")}return a},points2area:function(e){var n=this,i=e.length,o=n.getBaseValue(),u=e[0],a=e[i-1],f=n.isInCircle(),l,c="";if(i){l=n.points2path(e);if(f){var h=n.getCircleCenter();c=l}else{c="M "+u.x+" "+o,c+=l.replace("M","L");if(s.test(c)){c=r.parsePathString(c);var p=[],d=u;t.each(c,function(e,t){if(t!==0&&e[0]=="M"){var n=[],r=[],i=[],s=c[t-1];n[0]="L",n[1]=s[1],n[2]=o,r[0]="L",r[1]=d.x,r[2]=o,i[0]="M",i[1]=e[1],i[2]=o,s[0]=="R"?(s[0]="L",e[0]="R"):e[0]="L",p.push(n),p.push(r),p.push(i),d=e}p.push(e)}),c=p,c.push(["L",a.x,o]),r.svg&&c.push(["Z"])}else c=c+"L "+a.x+" "+o+"z"}}return c}}),u}),define("bui/chart/scatterseries",["bui/chart/cartesianseries","bui/chart/activedgroup"],function(e){function i(e,t,n){e&&!e[t]&&(e[t]=n)}var t=e("bui/common"),n=e("bui/chart/cartesianseries"),r=e("bui/chart/activedgroup"),s=function(e){s.superclass.constructor.call(this,e)};return s.ATTRS={elCls:{value:"x-chart-scatter"},stickyTracking:{value:!1},animate:{value:!1}},t.extend(s,n),t.augment(s,{processColor:function(){var e=this,t=e.get("color");if(t){var n=e.get("markers");n&&(i(n.marker,"stroke",t),i(n.marker,"fill",t))}},draw:function(e){var n=this;t.each(e,function(e){n.addMarker(e)})},onMouseOver:function(){var e=this,t=e.get("markersGroup");t&&t.on("mouseover",function(e){var n=e.target,r=n.shape;r&&t.setActivedItem(r)})},getTrackingInfo:function(){var e=this,t=e.get("markersGroup"),n,r,i;return t&&(n=t.getActived(),n&&(r=n.get("point"))),r},onMouseOut:function(){var e=this,t=e.get("markersGroup");t&&t.on("mouseout",function(e){var n=e.target,r=n.shape;r&&t.clearActivedItem(r)})}}),s}),define("bui/chart/bubbleseries",["bui/common","bui/chart/cartesianseries","bui/graphic","bui/chart/activedgroup"],function(e){var t=e("bui/common"),n=e("bui/chart/cartesianseries"),r=e("bui/chart/activedgroup"),i=e("bui/graphic").Util,s=function(e){s.superclass.constructor.call(this,e)};return s.ATTRS={elCls:{value:"x-chart-bubble"},type:{value:"buble"},circle:{shared:!1,value:{}},activeCircle:{value:{}},animate:{value:!0},stickyTracking:{value:!1}},t.extend(s,n),t.mixin(s,[r]),t.augment(s,{processColor:function(){var e=this,t=e.get("color");if(t){var n=e.get("circle");n&&(i.trySet(n,"stroke",t),i.trySet(n,"fill",t))}},renderUI:function(){s.superclass.renderUI.call(this),this._renderGroup()},draw:function(e){var n=this;t.each(e,function(e){n.addBubble(e)})},changeShapes:function(){var e=this,n=e.getPoints(),r=e.getItems();t.each(r,function(t,r){var i=n[r];t.animate({cx:i.x,cy:i.y},e.get("changeDuration")),t.set("point",i)})},getItems:function(){return this.get("group").get("children")},getActiveItems:function(){return this.getItems()},_renderGroup:function(){var e=this,t=e.addGroup();e.set("group",t)},setItemActived:function(e,t){var n=this,r=n.get("circle"),i=n.get("activeCircle");t?(e.attr(i),e.set("actived",!0)):(e.attr(r),e.set("actived",!1))},getTrackingInfo:function(){var e=this,t=e.getActived();return t&&t.get("point")},isItemActived:function(e){return e.get("actived")},addBubble:function(e){var n=this,r=n.get("circle"),s=5,o,u=t.mix({},r),a;e.obj&&(s=e.obj.r),e.arr&&(s=e.arr[2]),o=n._getRadius(s),u.cx=e.x,u.cy=e.y,n.get("animate")&&i.svg?(u.r=0,a=n.get("group").addShape("circle",u),a.animate({r:o},n.get("duration"))):(u.r=o,a=n.get("group").addShape("circle",u)),a.set("point",e)},_getRadius:function(e){return Math.pow(e,.75)},onMouseOver:function(){var e=this;e.get("group").on("mouseover",function(t){var n=t.target,r=n.shape;e.setItemActived(r,!0)})},onMouseOut:function(){var e=this;e.get("group").on("mouseout",function(t){var n=t.target,r=n.shape;e.setItemActived(r,!1)})}}),s}),define("bui/chart/columnseries",["bui/common","bui/graphic","bui/chart/activedgroup","bui/chart/series/stacked"],function(e){function u(e,t){var n=Raphael.color(e),r=n.l*(1+t);return Raphael.hsl2rgb(n.h,n.s,r).hex}function a(e,t,n,r,i){var s=i.getCenter(),o,u=s.x,a=s.y,f=i.getCirclePoint(e,n),l=i.getCirclePoint(t,n);if(!r)o=["M",u,a,"L",f.x,f.y,"A",n,n,0,+(t-e>180),1,l.x,l.y,"z"];else{var c=i.getCirclePoint(e,r),h=i.getCirclePoint(t,r);o=[],o.push(["M",c.x,c.y]),o.push(["L",f.x,f.y]),o.push(["A",n,n,0,+(t-e>180),1,l.x,l.y]),o.push(["L",h.x,h.y]),o.push(["A",r,r,0,+(t-e>180),0,c.x,c.y]),o.push(["z"])}return o}var t=e("bui/common"),n=e("bui/graphic").Util,r=e("bui/chart/cartesianseries"),i=e("bui/chart/activedgroup"),s=e("bui/chart/series/stacked"),o=e("bui/chart/series/itemgroup"),f=function(e){f.superclass.constructor.call(this,e)};return f.ATTRS={type:{value:"column"},elCls:{value:"x-chart-column"},columnWidth:{},columnOffset:{value:0},cancelSelect:{value:!1},stackPadding:{value:1},animate:{value:!0},duration:{value:1e3},item:{shared:!1,value:{stroke:"none","stroke-width":1,"fill-opacity":.75}}},t.extend(f,r),t.mixin(f,[o,i,s]),t.augment(f,{processColor:function(){var e=this,t=e.get("color");if(t){var n=e.get("item");n.fill||(n.fill=t)}},bindUI:function(){f.superclass.bindUI.call(this),this.bindItemClick()},draw:function(e){var n=this;n.resetWidth(),t.each(e,function(e,t){n._drawPoint(e,t)}),n.get("animate")&&n.animateItems(),n.sort()},_drawPoint:function(e,t){var n=this,r=n.addItem(e,t);if(n.get("labels")){var i=n.addLabel(e.value,e);r.set("label",i)}},addPoint:function(e,t,n){var r=this,i=r.get("data");i.push(e),t&&(i.shift(),n&&r.shiftPoint()),r.changeData(i,n)},shiftPoint:function(){var e=this,t=e.getItems()[0];t&&t.remove(),f.superclass.shiftPoint.call(this)},resetWidth:function(){if(this.isInCircle()){this.resetCircleWidth();return}var e=this,t,n=e.get("xAxis"),r=n.getTickAvgLength(),i,s=10,o,u,a=e._getIndexInfo();i=a.count,t=a.curIndex,o=r/2/i,s=.5*o,u=.5*(r-i*o-(i-1)*s)+((t+1)*o+t*s)-.5*o-.5*r,e.set("columnWidth",o),e.set("columnOffset",u)},_getIndexInfo:function(){var e=this,n=e.get("parent"),r=n.getSeries(),i,s,o=[];return e.isStacked()?(s=1,i=0):(t.each(r,function(e){e.get("visible")&&e.get("type")=="column"&&o.push(e)}),s=o.length,i=t.Array.indexOf(e,o)),{curIndex:i,count:s}},resetCircleWidth:function(){var e=this,t,n=e.get("xAxis"),r=n.getTickAvgAngle(),i,s,o;info=e._getIndexInfo(),i=info.count,t=info.curIndex,s=r/i,o=t*s,e.set("columnWidth",s),e.set("columnOffset",o)},changeShapes:function(e){var t=this;t.resetWidth(),t.changePoints(e)},getActiveItems:function(){return this.getItems()},isItemActived:function(e){return e.get("actived")},setItemActived:function(e,t){var n=this,r=e.getCfgAttr("attrs").fill;t?(e.attr("fill",u(r,.2)),e.set("actived",!0)):(e.attr("fill",r),e.set("actived",!1))},setItemSelected:function(e,t){var r=this,i=e.getCfgAttr("attrs"),s=i.fill,o=i.stroke,u=i["stroke-width"];t?(e.attr({stroke:n.dark(s,.3),"stroke-width":2}),e.set("selected",!0)):(e.attr({stroke:o,"stroke-width":u}),e.set("selected",!1))},onStickyTracking:function(e){var n=this,r=n.getTrackingInfo(e.point),i=n.getItems();r&&t.each(i,function(e){e.get("point").x==r.x&&e.get("point").y==r.y&&n.setActivedItem(e)})},pointToFactorPath:function(e,t){var n=this,r=n.get("item"),i=n.get("columnWidth"),s=n.get("columnOffset"),o,u,f=0,l=n.getBaseValue(),c=n.isInCircle(),h=[];if(c){var p=n.get("xAxis"),d=e.xValue,v=s+d,m=s+d+i,g=e.r||p.getDistance(e.x,e.y),y=e.ir||0;g*=t,y*=t,h=a(v,m,g,y,p)}else n.isStacked()&&e.lowY?(u=e.lowY,f=n.get("stackPadding")):u=l,u-=f,o=e.y-u,h.push(["M",e.x+s-i/2,l+(u-l)*t]),h.push(["v",o*t]),h.push(["h",i]),h.push(["v",-1*o*t]),h.push(["z"]);return h},processPoint:function(e,t){var n=this,r=n.get("stackType");r&&r!="none"&&n.processStackedPoint(e,t)}}),f}),define("bui/chart/pieseries",["bui/common","bui/graphic","bui/chart/baseseries","bui/chart/series/itemgroup"],function(e){function o(e,n){if(t.isNumber(n))return n;var r=f(e),i=a(n),s=r.getWidth();return r.tl.x+s*i}function u(e,n){if(t.isNumber(n))return n;var r=f(e),i=a(n),s=r.getHeight();return r.tl.y+s*i}function a(e){return parseFloat(e)*.01}function f(e){return e.get("parent").get("plotRange")}function l(e,t,n,r,i){var s=n-Math.acos((r-t)/r)/Math.PI*180;e.orignAngle=e.angle,e.angle=s,e.orignX=e.x,e.orignY=e.y,e.x=i.x+(r+5)*Math.cos(e.angle*h),e.y=i.y+(r+5)*Math.sin(e.angle*h)}function c(e,t,n,r,i){var s=parseInt(t*2/d,10),o=e.y+t,u=e.y-t;s<n.length&&n.splice(s,n.length-s);var a=0,f=n.length,c,h;for(var p=0;p<f;p++){var v=n[p],m=v.angle,g=v.y;h=f-p,c=i>0?(o-g)/h:(g-u)/h,a=p;if(c<d){a=p+1;break}}if(a&&a<f-1){var y=a-1,b=n[y],g=b.y,w=i>0?o:u;h=f-y-1,c=Math.abs(w-g)/h,c<d&&(c=d);for(var p=f-1;p>=y;p--){var E=(f-1-p)*c;l(n[p],E,r,t,e)}var S=i>0?u:o,x=!1;for(var p=y-1;p>0;p--){var T=n[p];!x&&Math.abs(S-T.y)/(p+1)<d&&(x=!0);if(x){var E=Math.abs(n[p+1].y-w)+d;l(n[p],E,r,t,e)}}}}var t=e("bui/common"),n=e("bui/chart/series/itemgroup"),r=e("bui/chart/activedgroup"),i=e("bui/graphic").Util,s=e("bui/chart/baseseries"),h=Math.PI/180,p=5,d=16,v=function(e){v.superclass.constructor.call(this,e)};return v.ATTRS={size:{value:"80%"},innerSize:{},center:{value:["50%","50%"]},colors:{},colorHighlight:{value:0},radius:{},startAngle:{value:-90},endAngle:{value:270},xField:{value:"name"},stickyTracking:{value:!1},animate:{value:!0},duration:{value:1e3}},t.extend(v,s),t.mixin(v,[n,r]),t.augment(v,{draw:function(e){function i(){r&&n.setSelected(r)}var n=this,r;t.each(e,function(e,t){n.formatPoint(e,t);var i=n.addItem(e,t);e.obj&&e.obj.selected&&(r=i)}),n.get("animate")?n.animateItems(i):i(),n.get("labelsGroup")&&(n.processLabels(e),n.get("labelsGroup").toFront())},changeShapes:function(e,n){var r=this;t.each(e,function(e,t){r.formatPoint(e,t)}),r.changePoints(e)},processLabels:function(e){var n=this,r=n.get("labelsGroup"),i=r.get("distance"),s=[],o=n.getCenter(),u=n.getRadius(),a=u+i,f=n.get("startAngle"),l=n.get("endAngle"),h=[];t.each(e,function(e){var t=n._getLabelCfg(e,i,a);i<0?r.addLabel(t):t.factor>0?h.push(t):s.push(t)});if(s.length){var p;f>=-90?p=270:p=-90,c(o,a,s,p,-1),t.each(s,function(e){r.addLabel(e),n.lineToLabel(e,u,i)})}h.length&&(c(o,a,h,90,1),t.each(h,function(e){r.addLabel(e),n.lineToLabel(e,u,i)}))},resetLabels:function(){var e=this,t=e.get("labelsGroup"),n=e.get("lineGroup");t&&(t.clear(),n&&n.clear(),e.processLabels(e.getPoints()))},lineToLabel:function(e,t,n){var r=this,i=e.orignAngle||e.angle,s=r.getCenter(),o=r._getOffset(i,t+p/2),u,a=r.get("lineGroup"),f=[];f.push(["M",s.x+o.x,s.y+
o.y]),e.orignX!=null?(u=r._getOffset(i,t+n/2),f.push(["R",s.x+u.x,s.y+u.y,e.x,e.y])):f.push(["L",e.x,e.y]),a||(a=r.addGroup(),r.set("lineGroup",a)),a.addShape("path",{path:f,fill:null,stroke:e.color})},bindUI:function(){v.superclass.bindUI.call(this),this.bindItemClick()},onMouseOver:function(){var e=this;e.on("mouseover",function(t){var n=t.target,r=n.shape;r&&e.setActivedItem(r)})},_getLabelCfg:function(e,t,n){var r=this,i=e.startAngle+(e.endAngle-e.startAngle)/2,s=r.getCenter(),o=s.x+(n+p)*Math.cos(i*h),u=s.y+(n+p)*Math.sin(i*h),a={},f=1;return a.x=o,a.y=u,t<0?i>-90&&i<=90?(a["text-anchor"]="end",a.rotate=i):(a["text-anchor"]="start",a.rotate=i-180):i>-90&&i<=90?(a["text-anchor"]="start",f=1):(f=-1,a["text-anchor"]="end"),a.factor=f,a.angle=i,a.color=e.color,a.point=e,a.text=e.xValue,a},getActiveItems:function(){return this.getItems()},setItemActived:function(e,t){var n=this,r=e.getCfgAttr("attrs").fill;t?(e.attr({fill:i.highlight(r,.1)}),e.set("actived",!0)):(e.attr({fill:r}),e.set("actived",!1))},getTrackingInfo:function(){var e=this,t=e.getActived();return t&&t.get("point")},isItemActived:function(e){return e.get("actived")},getRadius:function(){var e=this,t=e.get("radius");return t||(t=e.calculateRadius(e.get("size")),e.set("radius",t)),t},getInnerRadius:function(){var e=this,t=e.get("innerRadius"),n=e.get("innerSize");return!t&&n&&(t=e.calculateRadius(n),e.set("innerRadius",t)),t},calculateRadius:function(e){var t=this,n=t.get("parent").get("plotRange"),r=a(e);return Math.min(n.getWidth(),n.getHeight())/2*r},getCenter:function(){var e=this,t=e.get("centerPoint"),n;return t||(t={},n=e.get("center"),t.x=o(e,n[0]),t.y=u(e,n[1]),e.set("centerPoint",t)),t},getItemCfg:function(e,n){var r=this,i=r.get("item"),s=e.obj,o={};return t.mix(o,i),s&&s.attrs&&t.mix(o,s.attrs),o.fill=e.color,r.get("allowPointSelect")&&(o.cursor="pointer"),o},_getColor:function(e){var t=this,n=t.get("colors"),r=t.get("colorHighlight"),s;return e%=n.length,s=n[e],r&&(s=i.highlight(r)),s},formatPoint:function(e,t){var n=this,r=n.getVisiblePoints(),i=n._getPiePercent(e,r),s=n.get("startAngle"),o=n.get("endAngle"),u=o-s,a={};e.percent=i.percent,e.obj&&e.obj.attrs&&(e.color=e.obj.attrs.fill),e.color=e.color||n._getColor(t),e.prePercent=i.prePercent,e.startAngle=s+u*i.prePercent,e.endAngle=s+u*(e.prePercent+e.percent)},getPointByValue:function(e,t){return{xValue:e,value:t}},_getPiePercent:function(e,n){var r=this,i=0,s=0,o=t.Array.indexOf(e,n),u={};return t.each(n,function(e,t){t<o&&(s+=e.value),i+=e.value}),u.percent=e.value/i,u.prePercent=s/i,u},getVisiblePoints:function(){var e=this,t;return e.getPoints()},animateItem:function(e,t){var n=this,r=e.get("point"),s=r.startAngle,o=r.endAngle,u=t==e.get("prePoint"),a=u?t.startAngle:t.endAngle,f=u?t.endAngle:t.endAngle,l=e.get("animHadler");l&&i.stopStep(l),l=i.animStep(n.get("changeDuration"),function(t){var r,i,l;u?(i=a+(s-a)*t,l=f+(o-f)*t):(i=a-(a-s)*t,l=f-(f-o)*t),r=n._getPiePath(i,l),e.attr("path",r);if(n.isSelected(e)){var c=n._getOffset(i,l,10);e.attr("transform","t"+c.x+" "+c.y)}}),e.set("animHadler",l)},pointToFactorPath:function(e,t){var n=this,r=n.get("startAngle"),i,s;return i=e.startAngle,s=e.endAngle,n._getPiePath(r+(i-r)*t,r+(s-r)*t)},_getPiePath:function(e,t){var n=this,r=n.getCenter(),i,s=r.x,o=r.y,u=n.getRadius(),a=n.getInnerRadius(),f=s+u*Math.cos(e*h),l=s+u*Math.cos(t*h),c=o+u*Math.sin(e*h),p=o+u*Math.sin(t*h);if(!a)i=["M",s,o,"L",f,c,"A",u,u,0,+(t-e>180),1,l,p,"z"];else{var d=s+a*Math.cos(e*h),v=s+a*Math.cos(t*h),m=o+a*Math.sin(e*h),g=o+a*Math.sin(t*h);i=[],i.push(["M",d,m]),i.push(["L",f,c]),i.push(["A",u,u,0,+(t-e>180),1,l,p]),i.push(["L",v,g]),i.push(["A",a,a,0,+(t-e>180),0,d,m]),i.push(["z"])}return i},_getOffset:function(e,t,n){var r=this,i,s={};return n==null?(i=e,n=t):i=e+(t-e)/2,s.x=n*Math.cos(i*h),s.y=n*Math.sin(i*h),s},setItemSelected:function(e,t){var n=this,r=e.get("point"),i=n.get("changeDuration"),s;t?(s=n._getOffset(r.startAngle,r.endAngle,10),e.animate({transform:"t"+s.x+" "+s.y},i)):e.animate({transform:"t0 0"},i),e.set("selected",t)}}),v}),define("bui/chart/series",["bui/chart/baseseries","bui/chart/lineseries","bui/chart/areaseries","bui/chart/columnseries","bui/chart/scatterseries","bui/chart/bubbleseries","bui/chart/pieseries"],function(e){var t=e("bui/chart/baseseries");return t.Line=e("bui/chart/lineseries"),t.Area=e("bui/chart/areaseries"),t.Column=e("bui/chart/columnseries"),t.Scatter=e("bui/chart/scatterseries"),t.Bubble=e("bui/chart/bubbleseries"),t.Pie=e("bui/chart/pieseries"),t}),define("bui/chart/seriesgroup",["bui/common","bui/chart/plotitem","bui/chart/legend","bui/chart/activedgroup","bui/chart/series","bui/chart/tooltip","bui/chart/axis"],function(e){function l(e,t){return e>t?t:e}function c(e,t){return e>t?e:t}function h(e){h.superclass.constructor.call(this,e)}var t=e("bui/common"),n=e("bui/chart/activedgroup"),r=e("bui/chart/plotitem"),i=e("bui/chart/legend"),s=e("bui/chart/tooltip"),o=e("bui/chart/axis"),u=e("bui/chart/series"),a=120,f=80;return h.ATTRS={elCls:{value:"x-chart-series-group"},zIndex:{value:5},plotRange:{},colors:{value:["#2f7ed8","#0d233a","#8bbc21","#910000","#1aadce","#492970","#f28f43","#77a1e5","#c42525","#a6c96a"]},symbols:{value:["circle","diamond","square","triangle","triangle-down"]},seriesOptions:{value:{}},series:{},legend:{},xAxis:{},yAxis:{},tooltip:{},stackedData:{},data:{},itemName:{value:"series"}},t.extend(h,r),t.mixin(h,[n]),t.augment(h,{renderUI:function(){var e=this;h.superclass.renderUI.call(e),e._renderLegend(),e._renderSeries(),e._renderAxis(),e._addSeriesAxis(),e._paintAxis(e.get("xAxis"),"xAxis"),e._paintAxis(e.get("yAxis"),"yAxis"),e._paintSeries(),e._renderTooltip()},bindUI:function(){var e=this;h.superclass.bindUI.call(e),e.bindCanvasEvent()},bindCanvasEvent:function(){var e=this,n=e.get("tipGroup").get("triggerEvent"),r=e.get("canvas");if(n=="click"){function i(t){!$.contains(r.get("node"),t.target)&&r.get("node")!=t.target&&(e.onTriggerOut(t),$(document).off("click",i))}r.on("click",function(t){e.onCanvasMove(t),setTimeout(function(){$(document).off("click",i).on("click",i)})})}else r.on("mousemove",t.wrapBehavior(e,"onCanvasMove")),r.on("mouseout",t.wrapBehavior(e,"onMouseOut"))},onCanvasMove:function(e){var t=this,n=t.get("canvas"),r=t.get("tipGroup"),i,s;if(!r)return;i=n.getPoint(e.pageX,e.pageY),t._isInAxis(i)?t._processTracking(i,r):t.onMouseOut()},onTriggerOut:function(e){var n=this,r=n.get("tipGroup");n.clearActivedItem(),r.get("visible")&&(r.get("shared")&&t.each(n.getVisibleSeries(),function(e){var t=e.get("markersGroup");t&&t.clearActivedItem()}),n._hideTip())},onMouseOut:function(e){var t=this;if(e&&e.target!=t.get("canvas").get("none"))return;t.onTriggerOut(e)},getSeries:function(){return this.get("children")},_processTracking:function(e,n){var r=this,i=[],s;if(!n.get("shared")){var o=r.getActived();o&&i.push(o)}else i=r.getSeries();t.each(i,function(t){t&&t.get("stickyTracking")&&t.get("visible")&&t.onStickyTracking({point:e})}),i.length&&(s=r._getTipInfo(i,e),s.items.length&&r._showTooltip(s.title,s.point,s.items))},_getTipInfo:function(e,n){var r={items:[],point:{}},i=0,s=this.get("tipGroup").get("pointRenderer");return t.each(e,function(t,o){var u=t.getTrackingInfo(n),a={},f;if(u){if(t.get("visible")){i+=1,a.name=t.get("name"),a.value=s?s(u,t):t.getTipItem(u),a.color=u.color||t.get("color"),r.items.push(a);var l=t.get("markersGroup");if(l&&l.get("single")){var c=l.getChildAt(0);c&&c.attr({x:u.x,y:u.y})}}t.get("xAxis")?f=t.get("xAxis").formatPoint(u.xValue):f=u.xValue,i==1&&(r.title=f,u.x?(r.point.x=u.x,e.length==1?r.point.y=u.y:r.point.y=n.y):(r.point.x=n.x,r.point.y=n.y))}}),r},_showTooltip:function(e,t,n){var r=this,i=r.get("tipGroup"),s=r.get("prePoint");if(!s||s.x!=t.x||s.y!=t.y)i.setTitle(e),i.setItems(n),i.setPosition(t.x,t.y),i.get("visible")||i.show(),r.set("prePoint",t)},_hideTip:function(){var e=this,t=e.get("tipGroup");t&&t.get("visible")&&(t.hide(),e.set("prePoint",null))},_isInAxis:function(e){var t=this,n=t.get("plotRange");return n.isInRange(e)},_renderSeries:function(){var e=this,n=e.get("series");t.each(n,function(t,n){e.addSeries(t,n)})},_renderLegend:function(){var e=this,t=e.get("legend"),n;t&&(t.items=t.items||[],t.plotRange=e.get("plotRange"),n=e.get("parent").addGroup(i,t),e.set("legendGroup",n))},_renderTooltip:function(){var e=this,t=e.get("tooltip"),n;t&&(t.plotRange=e.get("plotRange"),n=e.get("parent").addGroup(s,t),e.set("tipGroup",n))},_renderAxis:function(){var e=this,n=e.get("xAxis"),r=e.get("yAxis");n&&!n.isGroup&&(n=e._createAxis(n),e.set("xAxis",n));if(t.isArray(r)&&!r[0].isGroup){var i=[];t.each(r,function(t){i.push(e._createAxis(t)),e.set("yAxis",i)})}else r&&!r.isGroup&&(n&&n.get("type")=="circle"&&(r.type="radius",r.circle=n),r=e._createAxis(r),e.set("yAxis",r))},_createAxis:function(e){var n=this,r=e.type,i,s;return e.categories?r="category":!e.ticks&&r!="circle"&&(e.autoTicks=!0),r=="category"&&!e.categories&&(e.autoTicks=!0),e.plotRange=n.get("plotRange"),e.autoPaint=!1,r=r||"number",s=t.ucfirst(r),i=o[s],i?n.get("parent").addGroup(i,e):null},_caculateAxisInfo:function(e,t){if(e.get("type")=="category")return this._caculateCategories(e,t);var n=this,r=[],i=e.get("type"),s=e.getLength(),u=Math.floor(s/a),l=Math.ceil(s/f),c,h,p,d,v,m,g;if(i=="number"||i=="radius")p=e.getCfgAttr("min"),d=e.getCfgAttr("max"),m=o.Auto;else if(i=="time"){var y=e.get("startDate"),b=e.get("endDate");y&&(p=y.getTime()),b&&(d=b.getTime()),m=o.Auto.Time}v=e.getCfgAttr("tickInterval"),h=n.getSeries();var w={min:p,max:d,interval:v};return t=="yAxis"&&(w.maxCount=l,w.minCount=u,c=h[0].get("stackType")),c&&c!="none"?r=n.getStackedData(e,t):r=n.getSeriesData(e,t),r.length?(w.data=r,g=m.caculate(w,c)):g={ticks:[]},g},_caculateCategories:function(e,n){var r=this,i=r.getSeriesData(e,n),s=[];i.length&&(s=s.concat(i[0]));if(i.length>1&&!r.get("data"))for(var o=1;o<i.length;o++){var u=i[o];t.each(u,function(e){t.indexOf(e)||s.push(e)})}return{categories:s}},getSeriesData:function(e,n){var r=this,i=[],s=r.getVisibleSeries();return e=e||r.get("yAxis"),n=n||"yAxis",t.each(s,function(t){if(t.get(n)==e){var r=t.getData(n);r.length&&i.push(r)}}),i},_parseData:function(e,n){var r=[];return t.each(n,function(t){r.push(e[t])}),r},getStackedData:function(e,n){var r=this,i,s;return stackedData=r.get("stackedData"),arr=[],stackedData?arr=stackedData:(i=r.getSeriesData(e,n),s=i[0],t.each(s,function(e,t){var n=e;for(var r=1;r<i.length;r++)n+=i[r][t];arr.push(n)}),r.set("stackedData",arr)),arr},_paintAxis:function(e,n){var r=this,i;t.isArray(e)?i=e:i=[e],t.each(i,function(e,t){if(r._hasRelativeSeries(e,n)){if(e.get("autoTicks")){var i=r._caculateAxisInfo(e,n);e.changeInfo(i)}e.paint()}})},_hasRelativeSeries:function(e,n){var r=this,i=r.getVisibleSeries(),s=!1;return t.each(i,function(t){if(t.get(n)==e)return s=!0,!1}),s},_resetAxis:function(e,t){if(!e.get("autoTicks"))return;t=t||"yAxis";var n=this,r=n._caculateAxisInfo(e,t),i=n.getSeries();n.set("stackedData",null),e.change(r)},_resetSeries:function(){var e=this,n=e.getSeries();t.each(n,function(e){e.get("visible")&&e.repaint()})},repaint:function(){var e=this,n=e.get("xAxis"),r=e.get("yAxis");n&&e._resetAxis(n,"xAxis"),r&&(t.isArray(r)?t.each(r,function(t){e._resetAxis(t,"yAxis")}):e._resetAxis(r,"yAxis")),e._resetSeries()},changeData:function(e){var n=this,r=n.getSeries(),i=n.get("fields");n.set("data",e),t.each(r,function(t,r){if(i){var s=n._getSeriesData(t.get("name"),r);t.changeData(s)}else t.changeData(e)}),n.repaint()},_getSeriesData:function(e,n){var r=this,i=r.get("data"),s=r.get("fields"),o=i[n];return e&&t.each(i,function(t){if(t.name==e)return o=t,!1}),r._parseData(o,s)},_getDefaultType:function(){var e=this,n=e.get("seriesOptions"),r="line";return t.each(n,function(e,t){return r=t.replace("Cfg",""),!1}),r},getVisibleSeries:function(){var e=this,n=e.getSeries();return t.Array.filter(n,function(e){return e.get("visible")})},addSeries:function(e,t){var n=this,r=e.type||n._getDefaultType(),i=n._getSeriesClass(r),s=n._getSeriesCfg(r,e,t),o;return s.autoPaint=s.autoPaint||!1,o=n.addGroup(i,s),n._addLegendItem(o),o},_paintSeries:function(){var e=this,n=e.getSeries();t.each(n,function(e){e.paint()})},_addSeriesAxis:function(){var e=this,n=e.getSeries();t.each(n,function(n){if(n.get("type")=="pie")return!0;n.get("xAxis")||n.set("xAxis",e.get("xAxis"));var r=e.get("yAxis");n.get("yAxis")==null&&(t.isArray(r)?n.set("yAxis",r[0]):n.set("yAxis",r)),t.isNumber(n.get("yAxis"))&&n.set("yAxis",r[n.get("yAxis")])})},showSeries:function(e){var t=this;e.get("visible")||(e.show(),t._resetAxis(e.get("yAxis")),t._resetSeries())},hideSeries:function(e){var t=this;e.get("visible")&&(e.hide(),t._resetAxis(e.get("yAxis")),t._resetSeries())},_addLegendItem:function(e){var t=this,n=t.get("legendGroup");n&&n.addItem({series:e})},_getSeriesCfg:function(e,n,r){var i=this,s=i.get("seriesOptions"),o=i.get("colors"),u=i.get("data"),a=i.get("fields"),f=i.get("symbols");return n=t.mix(!0,{},s[e+"Cfg"],n),!n.color&&o.length&&(n.color=o[r%o.length]),n.markers&&n.markers.marker&&!n.markers.marker.symbol&&(n.markers.marker.symbol=f[r%f.length]),u&&!n.data&&(a?n.data=i._getSeriesData(n.name,r):n.data=u),n},_getSeriesClass:function(e){var n=t.ucfirst(e),r=u[n]||u;return r},remove:function(){var e=this,n=e.get("canvas");n.off("mousemove",t.getWrapBehavior(e,"onCanvasMove")),n.off("mouseout",t.getWrapBehavior(e,"onMouseOut")),h.superclass.remove.call(e)}}),h}),define("bui/chart/chart",["bui/common","bui/graphic","bui/chart/plotback","bui/chart/theme","bui/chart/seriesgroup"],function(e){function o(e,n){var r={},i=!1;return t.each(e,function(i,s){r[s]=n[s],t.isObject(r[s])?t.mix(!0,r[s],e[s]):r[s]=e[s]}),i||(r.lineCfg=n.lineCfg),r}var t=e("bui/common"),n=e("bui/chart/plotback"),r=e("bui/graphic"),i=e("bui/chart/seriesgroup"),s=e("bui/chart/theme"),u=t.Component.Controller.extend([t.Component.UIBase.Bindable],{renderUI:function(){var e=this;e.paint()},clear:function(){var e=this,t=e.get("canvas");t.destroy(),e.set("isPaint",!1)},paint:function(){var e=this;e.get("isPaint")||(e._renderCanvas(),e._renderPlot(),e._renderTitle(),e._renderSeries(),e.get("canvas").sort())},_renderCanvas:function(){var e=this,t=e.get("el"),n=e.get("width")||t.width(),i=e.get("height")||t.height(),s=new r.Canvas({width:n,height:i,render:t});s.chart=e,e.set("canvas",s)},_renderPlot:function(){var e=this,r=e.get("plotCfg"),i=e.get("canvas"),s=e.get("theme"),o,u;r=t.mix({},s.plotCfg,r),o=i.addGroup(n,r),u=o.get("plotRange"),e.set("plotRange",u)},_renderTitle:function(){var e=this,n=e.get("title"),r=e.get("subTitle"),i=e.get("theme"),s=e.get("canvas");n&&(n.x==null&&(n.x=s.get("width")/2,n.y=n.y||15),n=t.mix({},i.title,n),s.addShape("label",n)),r&&(r.x==null&&(r.x=s.get("width")/2,r.y=r.y||35),r=t.mix({},i.subTitle,r),s.addShape("label",r))},_getDefaultType:function(){var e=this,n=e.get("seriesOptions"),r="line";return t.each(n,function(e,t){return r=t.replace("Cfg",""),!1}),r},_renderSeries:function(){var e=this,n=e.get("theme"),r={},s=e.getAttrVals(),o=e._getDefaultType(),u;t.each(s.series,function(e){e.type||(e.type=o)}),t.mix(!0,r,n,{colors:s.colors,data:s.data,fields:s.fields,plotRange:s.plotRange,series:s.series,seriesOptions:s.seriesOptions,tooltip:s.tooltip,legend:s.legend,xAxis:s.xAxis}),t.isObject(s.yAxis)?t.mix(!0,r,{yAxis:s.yAxis}):t.isArray(s.yAxis)&&(s.yAxis[0]=t.merge(!0,n.yAxis,s.yAxis[0]),r.yAxis=s.yAxis),u=e.get("canvas").addGroup(i,r),e.set("seriesGroup",u)},repaint:function(){var e=this;e.get("seriesGroup").repaint()},getSeries:function(){return this.get("seriesGroup").getSeries()},changeData:function(e){var t=this,n=t.get("seriesGroup");e!==t.get("data")&&t.set("data",e),n.changeData(e)},onLoad:function(){var e=this,t=e.get("store"),n=t.getResult();e.changeData(n)},onAdd:function(e){this.onLoad()},onRemove:function(e){this.onLoad()},onUpdate:function(e){this.onLoad()},onLocalSort:function(e){this.onLoad()},destructor:function(){var e=this;e.clear()}},{ATTRS:{canvas:{},colors:{},data:{},legend:{},menu:{},plotCfg:{},plotRange:{},series:{},seriesOptions:{},subTitle:{},title:{},tooltip:{},xAxis:{},yAxis:{},fields:{},theme:{value:s.Base}}},{xclass:"chart"});return u});
